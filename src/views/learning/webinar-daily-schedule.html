<div class="webinar-daily-schedule">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">ì¼ë³„ í™”ìƒê°•ì˜ í˜„í™©</h4>
            <p class="text-muted mb-0">ì „ì²´ ê°•ì‚¬ì˜ ì¼ë³„ ì˜ˆì•½ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•©ë‹ˆë‹¤</p>
        </div>
        <button class="btn btn-outline-primary" @click="goToReservations">
            <span class="me-1">ğŸ“‹</span> ì˜ˆì•½ ê´€ë¦¬
        </button>
    </div>

    <!-- ë‚ ì§œ ì„ íƒ -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body d-flex justify-content-between align-items-center">
            <button class="btn btn-outline-secondary" @click="previousDay">
                <span>â€¹ ì´ì „</span>
            </button>
            <div class="d-flex align-items-center gap-3">
                <input type="date" class="form-control" v-model="selectedDate" style="width: auto;">
                <h5 class="mb-0 fw-bold">{{ formatDate(selectedDate) }}</h5>
                <button class="btn btn-sm btn-outline-primary" @click="goToToday">ì˜¤ëŠ˜</button>
            </div>
            <button class="btn btn-outline-secondary" @click="nextDay">
                <span>ë‹¤ìŒ â€º</span>
            </button>
        </div>
    </div>

    <!-- í†µê³„ ì¹´ë“œ -->
    <div class="row g-3 mb-4">
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small mb-1">ì „ì²´ ì˜ˆì•½</div>
                    <div class="fs-3 fw-bold">{{ filteredReservations.length }}</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small mb-1">í™•ì •</div>
                    <div class="fs-3 fw-bold text-success">{{ filteredReservations.filter(r => r.status === 'confirmed').length }}</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small mb-1">ëŒ€ê¸°ì¤‘</div>
                    <div class="fs-3 fw-bold text-warning">{{ filteredReservations.filter(r => r.status === 'pending').length }}</div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="text-muted small mb-1">í™œì„± ê°•ì‚¬</div>
                    <div class="fs-3 fw-bold text-primary">{{ instructorSchedules.filter(i => i.reservations.length > 0).length }}</div>
                </div>
            </div>
        </div>
    </div>

    <!-- íƒ€ì„ë¼ì¸ ìŠ¤ì¼€ì¤„ -->
    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table mb-0" style="table-layout: fixed;">
                    <thead class="table-light" style="position: sticky; top: 0; z-index: 10;">
                        <tr>
                            <th style="width: 80px;">ì‹œê°„</th>
                            <th v-for="instructor in instructors" :key="instructor.id" class="text-center">
                                <div class="d-flex align-items-center justify-content-center gap-2">
                                    <span class="rounded-circle d-inline-block" :style="{ width: '12px', height: '12px', backgroundColor: instructor.color }"></span>
                                    <span class="fw-bold">{{ instructor.name }}</span>
                                </div>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="timeSlot in timeSlots" :key="timeSlot" style="height: 60px;">
                            <td class="text-center align-top small text-muted fw-bold" style="padding-top: 8px;">
                                {{ timeSlot }}
                            </td>
                            <td v-for="instructor in instructors" :key="instructor.id" class="p-1 align-top position-relative">
                                <div
                                    v-if="getReservationForTimeSlot(instructor.id, timeSlot)"
                                    class="rounded p-2 text-white position-relative"
                                    :style="{
                                        backgroundColor: instructor.color,
                                        height: getReservationHeight(getReservationForTimeSlot(instructor.id, timeSlot).duration) + 'px',
                                        cursor: 'pointer'
                                    }"
                                    @click="viewDetail(getReservationForTimeSlot(instructor.id, timeSlot))"
                                >
                                    <div class="small fw-bold">{{ getReservationForTimeSlot(instructor.id, timeSlot).studentName }}</div>
                                    <div style="font-size: 0.7rem; opacity: 0.9;">{{ getReservationForTimeSlot(instructor.id, timeSlot).courseTitle }}</div>
                                    <div style="font-size: 0.65rem; opacity: 0.8;">{{ getReservationForTimeSlot(instructor.id, timeSlot).duration }}ë¶„</div>
                                    <span
                                        class="badge position-absolute top-0 end-0 m-1"
                                        :class="getStatusBadge(getReservationForTimeSlot(instructor.id, timeSlot).status).class"
                                        style="font-size: 0.6rem;"
                                    >
                                        {{ getStatusBadge(getReservationForTimeSlot(instructor.id, timeSlot).status).text }}
                                    </span>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ì˜ˆì•½ ìƒì„¸ ëª¨ë‹¬ -->
    <div v-if="showDetailModal && selectedReservation" class="modal d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ì˜ˆì•½ ìƒì„¸ #{{ selectedReservation.id }}</h5>
                    <button type="button" class="btn-close" @click="showDetailModal = false"></button>
                </div>
                <div class="modal-body">
                    <div class="row g-3">
                        <div class="col-12">
                            <label class="form-label text-muted small">ê°•ì‚¬</label>
                            <div class="fw-bold">{{ selectedReservation.instructorName }}</div>
                        </div>
                        <div class="col-12">
                            <label class="form-label text-muted small">í•™ìƒ</label>
                            <div class="fw-bold">{{ selectedReservation.studentName }}</div>
                            <div class="small text-muted">{{ selectedReservation.studentEmail }}</div>
                        </div>
                        <div class="col-12">
                            <label class="form-label text-muted small">ê°•ì¢Œ</label>
                            <div class="fw-bold">{{ selectedReservation.courseTitle }}</div>
                        </div>
                        <div class="col-6">
                            <label class="form-label text-muted small">ì¼ì‹œ</label>
                            <div class="fw-bold">{{ selectedReservation.dateTime }}</div>
                        </div>
                        <div class="col-6">
                            <label class="form-label text-muted small">ì†Œìš” ì‹œê°„</label>
                            <div class="fw-bold">{{ selectedReservation.duration }}ë¶„</div>
                        </div>
                        <div class="col-12">
                            <label class="form-label text-muted small">ìƒíƒœ</label>
                            <div>
                                <span class="badge fs-6" :class="getStatusBadge(selectedReservation.status).class">
                                    {{ getStatusBadge(selectedReservation.status).text }}
                                </span>
                            </div>
                        </div>
                        <div class="col-12" v-if="selectedReservation.meetingUrl">
                            <label class="form-label text-muted small">íšŒì˜ ë§í¬</label>
                            <div>
                                <a :href="selectedReservation.meetingUrl" target="_blank" class="btn btn-sm btn-primary">
                                    ğŸ”— íšŒì˜ ì°¸ì—¬
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" @click="showDetailModal = false">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="content-author-page">
    <!-- í—¤ë” -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <div class="d-flex align-items-center gap-2 mb-2">
                <a href="#" @click.prevent="navigateTo('/learning/content')" class="text-muted">
                    â† ì½˜í…ì¸  ëª©ë¡
                </a>
            </div>
            <h4 class="mb-1">ì½˜í…ì¸  ì €ì‘ë„êµ¬</h4>
            <p class="text-muted mb-0">í˜ì´ì§€ ê¸°ë°˜ í•™ìŠµ ì½˜í…ì¸ ë¥¼ ì œì‘í•©ë‹ˆë‹¤</p>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-outline-secondary" @click="previewContent">
                <i class="bi bi-eye"></i> ë¯¸ë¦¬ë³´ê¸°
            </button>
            <button class="btn btn-outline-primary" @click="saveDraft">
                <i class="bi bi-save"></i> ì„ì‹œì €ì¥
            </button>
            <button class="btn btn-primary" @click="publishContent">
                <i class="bi bi-check-circle"></i> ê²Œì‹œ
            </button>
        </div>
    </div>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <div class="row">
        <!-- ì €ì‘ ì˜ì—­ -->
        <div class="col-lg-9">
            <!-- ì½˜í…ì¸  ë©”íƒ€ì •ë³´ -->
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-body">
                    <input type="text" class="form-control form-control-lg border-0 mb-2"
                           v-model="content.title"
                           placeholder="ì½˜í…ì¸  ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
                    <input type="text" class="form-control border-0 text-muted"
                           v-model="content.description"
                           placeholder="ê°„ë‹¨í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­)">
                </div>
            </div>

            <!-- í˜ì´ì§€ ëª©ë¡ -->
            <div class="card border-0 shadow-sm mb-3">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">í˜ì´ì§€ ëª©ë¡ ({{ content.blocks.length }}ê°œ)</h6>
                    <div class="dropdown">
                        <button class="btn btn-sm btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                            <i class="bi bi-plus"></i> í˜ì´ì§€ ì¶”ê°€
                        </button>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="#" @click.prevent="addBlock('text')">í…ìŠ¤íŠ¸</a></li>
                            <li><a class="dropdown-item" href="#" @click.prevent="addBlock('image')">ì´ë¯¸ì§€</a></li>
                            <li><a class="dropdown-item" href="#" @click.prevent="addBlock('video')">ë¹„ë””ì˜¤</a></li>
                            <li><a class="dropdown-item" href="#" @click.prevent="addBlock('quiz')">í€´ì¦ˆ</a></li>
                            <li><a class="dropdown-item" href="#" @click.prevent="addBlock('code')">ì½”ë“œ</a></li>
                            <li><a class="dropdown-item" href="#" @click.prevent="addBlock('file')">íŒŒì¼</a></li>
                        </ul>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        <button v-for="(block, index) in content.blocks" :key="block.id"
                                class="list-group-item list-group-item-action d-flex justify-content-between align-items-center"
                                :class="{ 'active': currentPageIndex === index }"
                                @click="currentPageIndex = index">
                            <div>
                                <strong>í˜ì´ì§€ {{ index + 1 }}</strong>
                                <span class="ms-2 badge bg-secondary">{{ getBlockTypeLabel(block.type) }}</span>
                            </div>
                            <div class="d-flex gap-1">
                                <button class="btn btn-sm btn-link text-muted" @click.stop="moveBlockUp(index)" :disabled="index === 0" title="ìœ„ë¡œ">
                                    <i class="bi bi-arrow-up"></i>
                                </button>
                                <button class="btn btn-sm btn-link text-muted" @click.stop="moveBlockDown(index)" :disabled="index === content.blocks.length - 1" title="ì•„ë˜ë¡œ">
                                    <i class="bi bi-arrow-down"></i>
                                </button>
                                <button class="btn btn-sm btn-link text-danger" @click.stop="deleteBlock(index)" title="ì‚­ì œ">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </button>
                        <div v-if="content.blocks.length === 0" class="text-center py-4 text-muted">
                            í˜ì´ì§€ë¥¼ ì¶”ê°€í•˜ì—¬ ì½˜í…ì¸ ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”
                        </div>
                    </div>
                </div>
            </div>

            <!-- í˜„ì¬ í˜ì´ì§€ í¸ì§‘ -->
            <div v-if="content.blocks.length > 0 && content.blocks[currentPageIndex]" class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">í˜ì´ì§€ {{ currentPageIndex + 1 }} í¸ì§‘</h6>
                        <select class="form-select form-select-sm w-auto" v-model="content.blocks[currentPageIndex].type" @change="onBlockTypeChange(currentPageIndex)">
                            <option value="text">í…ìŠ¤íŠ¸</option>
                            <option value="image">ì´ë¯¸ì§€</option>
                            <option value="video">ë¹„ë””ì˜¤</option>
                            <option value="quiz">í€´ì¦ˆ</option>
                            <option value="code">ì½”ë“œ</option>
                            <option value="file">íŒŒì¼</option>
                        </select>
                    </div>
                </div>
                <div class="card-body">
                    <!-- í…ìŠ¤íŠ¸ ë¸”ë¡ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'text'">
                        <div class="mb-2">
                            <select class="form-select form-select-sm w-auto d-inline-block"
                                    v-model="content.blocks[currentPageIndex].data.style">
                                <option value="normal">ë³¸ë¬¸</option>
                                <option value="h1">ì œëª© 1</option>
                                <option value="h2">ì œëª© 2</option>
                                <option value="h3">ì œëª© 3</option>
                            </select>
                        </div>
                        <textarea class="form-control border-0"
                                  v-model="content.blocks[currentPageIndex].data.content"
                                  :class="'text-style-' + content.blocks[currentPageIndex].data.style"
                                  placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                                  rows="10"
                                  @input="autoResize($event)"></textarea>
                    </div>

                    <!-- ì´ë¯¸ì§€ ë¸”ë¡ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'image'">
                        <div v-if="!content.blocks[currentPageIndex].data.url" class="text-center py-5 border rounded bg-light">
                            <input type="file" :id="'file-' + content.blocks[currentPageIndex].id"
                                   accept="image/*"
                                   @change="handleImageUpload($event, currentPageIndex)"
                                   class="d-none">
                            <label :for="'file-' + content.blocks[currentPageIndex].id" class="btn btn-outline-primary">
                                <i class="bi bi-image"></i> ì´ë¯¸ì§€ ì„ íƒ
                            </label>
                            <p class="text-muted small mt-2 mb-0">ë˜ëŠ” URLì„ ì…ë ¥í•˜ì„¸ìš”</p>
                            <input type="text" class="form-control mt-2 w-50 mx-auto"
                                   v-model="content.blocks[currentPageIndex].data.url"
                                   placeholder="https://...">
                        </div>
                        <div v-else>
                            <img :src="content.blocks[currentPageIndex].data.url" class="img-fluid rounded mb-3" :alt="content.blocks[currentPageIndex].data.caption">
                            <input type="text" class="form-control"
                                   v-model="content.blocks[currentPageIndex].data.caption"
                                   placeholder="ì´ë¯¸ì§€ ì„¤ëª… (ì„ íƒì‚¬í•­)">
                            <button class="btn btn-sm btn-outline-danger mt-2"
                                    @click="content.blocks[currentPageIndex].data.url = ''">
                                ì´ë¯¸ì§€ ë³€ê²½
                            </button>
                        </div>
                    </div>

                    <!-- ë¹„ë””ì˜¤ ë¸”ë¡ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'video'">
                        <div v-if="!content.blocks[currentPageIndex].data.url" class="text-center py-5 border rounded bg-light">
                            <div class="mb-3">
                                <select class="form-select form-select-sm w-auto d-inline-block"
                                        v-model="content.blocks[currentPageIndex].data.provider">
                                    <option value="youtube">YouTube</option>
                                    <option value="vimeo">Vimeo</option>
                                    <option value="file">íŒŒì¼ ì—…ë¡œë“œ</option>
                                </select>
                            </div>
                            <div v-if="content.blocks[currentPageIndex].data.provider !== 'file'">
                                <input type="text" class="form-control w-75 mx-auto"
                                       v-model="content.blocks[currentPageIndex].data.url"
                                       :placeholder="content.blocks[currentPageIndex].data.provider === 'youtube' ? 'YouTube URL' : 'Vimeo URL'">
                                <button class="btn btn-primary mt-2" @click="loadVideo(currentPageIndex)">
                                    ë¶ˆëŸ¬ì˜¤ê¸°
                                </button>
                            </div>
                            <div v-else>
                                <input type="file" :id="'video-' + content.blocks[currentPageIndex].id"
                                       accept="video/*"
                                       @change="handleVideoUpload($event, currentPageIndex)"
                                       class="d-none">
                                <label :for="'video-' + content.blocks[currentPageIndex].id" class="btn btn-outline-primary">
                                    <i class="bi bi-camera-video"></i> ë¹„ë””ì˜¤ íŒŒì¼ ì„ íƒ
                                </label>
                            </div>
                        </div>
                        <div v-else>
                            <div class="ratio ratio-16x9 mb-3">
                                <iframe v-if="content.blocks[currentPageIndex].data.provider === 'youtube'"
                                        :src="getYoutubeEmbedUrl(content.blocks[currentPageIndex].data.url)"
                                        allowfullscreen></iframe>
                                <iframe v-else-if="content.blocks[currentPageIndex].data.provider === 'vimeo'"
                                        :src="getVimeoEmbedUrl(content.blocks[currentPageIndex].data.url)"
                                        allowfullscreen></iframe>
                                <video v-else :src="content.blocks[currentPageIndex].data.url" controls class="w-100"></video>
                            </div>
                            <button class="btn btn-sm btn-outline-danger"
                                    @click="content.blocks[currentPageIndex].data.url = ''">
                                ë¹„ë””ì˜¤ ë³€ê²½
                            </button>
                        </div>
                    </div>

                    <!-- í€´ì¦ˆ ë¸”ë¡ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'quiz'">
                        <input type="text" class="form-control fw-bold mb-3"
                               v-model="content.blocks[currentPageIndex].data.question"
                               placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”">

                        <div class="mb-2">
                            <label class="form-label small text-muted">í€´ì¦ˆ ìœ í˜•</label>
                            <select class="form-select form-select-sm" v-model="content.blocks[currentPageIndex].data.quizType">
                                <option value="multiple">ê°ê´€ì‹ (ë‹¨ì¼ ì„ íƒ)</option>
                                <option value="checkbox">ê°ê´€ì‹ (ë³µìˆ˜ ì„ íƒ)</option>
                                <option value="short">ì£¼ê´€ì‹ (ë‹¨ë‹µí˜•)</option>
                                <option value="essay">ì£¼ê´€ì‹ (ì„œìˆ í˜•)</option>
                            </select>
                        </div>

                        <div v-if="content.blocks[currentPageIndex].data.quizType === 'multiple' || content.blocks[currentPageIndex].data.quizType === 'checkbox'">
                            <div v-for="(option, optIdx) in content.blocks[currentPageIndex].data.options"
                                 :key="optIdx"
                                 class="d-flex align-items-center gap-2 mb-2">
                                <input type="checkbox"
                                       class="form-check-input"
                                       v-model="option.correct"
                                       :disabled="content.blocks[currentPageIndex].data.quizType === 'multiple' && option.correct === false && content.blocks[currentPageIndex].data.options.some(o => o.correct)">
                                <input type="text" class="form-control"
                                       v-model="option.text"
                                       :placeholder="'ì„ íƒì§€ ' + (optIdx + 1)">
                                <button class="btn btn-sm btn-outline-danger"
                                        @click="removeQuizOption(currentPageIndex, optIdx)"
                                        :disabled="content.blocks[currentPageIndex].data.options.length <= 2">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                            <button class="btn btn-sm btn-outline-primary"
                                    @click="addQuizOption(currentPageIndex)">
                                <i class="bi bi-plus"></i> ì„ íƒì§€ ì¶”ê°€
                            </button>
                        </div>

                        <div v-if="content.blocks[currentPageIndex].data.quizType === 'short'" class="mt-3">
                            <label class="form-label small text-muted">ì •ë‹µ</label>
                            <input type="text" class="form-control"
                                   v-model="content.blocks[currentPageIndex].data.answer"
                                   placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”">
                        </div>

                        <div v-if="content.blocks[currentPageIndex].data.quizType === 'essay'" class="mt-3">
                            <label class="form-label small text-muted">ëª¨ë²” ë‹µì•ˆ (ì„ íƒì‚¬í•­)</label>
                            <textarea class="form-control"
                                      v-model="content.blocks[currentPageIndex].data.answer"
                                      rows="3"
                                      placeholder="ëª¨ë²” ë‹µì•ˆì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                        </div>

                        <div class="mt-3">
                            <label class="form-label small text-muted">í•´ì„¤ (ì„ íƒì‚¬í•­)</label>
                            <textarea class="form-control"
                                      v-model="content.blocks[currentPageIndex].data.explanation"
                                      rows="2"
                                      placeholder="ì •ë‹µ í•´ì„¤ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                        </div>
                    </div>

                    <!-- ì½”ë“œ ë¸”ë¡ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'code'">
                        <div class="mb-2">
                            <select class="form-select form-select-sm w-auto d-inline-block"
                                    v-model="content.blocks[currentPageIndex].data.language">
                                <option value="javascript">JavaScript</option>
                                <option value="python">Python</option>
                                <option value="java">Java</option>
                                <option value="html">HTML</option>
                                <option value="css">CSS</option>
                                <option value="sql">SQL</option>
                                <option value="other">ê¸°íƒ€</option>
                            </select>
                        </div>
                        <textarea class="form-control font-monospace bg-dark text-light"
                                  v-model="content.blocks[currentPageIndex].data.code"
                                  rows="12"
                                  placeholder="ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”..."
                                  style="font-size: 14px;"></textarea>
                    </div>

                    <!-- íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë¸”ë¡ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'file'">
                        <div v-if="!content.blocks[currentPageIndex].data.url" class="text-center py-4 border rounded bg-light">
                            <input type="file" :id="'download-' + content.blocks[currentPageIndex].id"
                                   @change="handleFileUpload($event, currentPageIndex)"
                                   class="d-none">
                            <label :for="'download-' + content.blocks[currentPageIndex].id" class="btn btn-outline-primary">
                                <i class="bi bi-file-earmark-arrow-up"></i> íŒŒì¼ ì„ íƒ
                            </label>
                        </div>
                        <div v-else class="d-flex align-items-center gap-3 p-3 border rounded">
                            <i class="bi bi-file-earmark-text fs-2 text-primary"></i>
                            <div class="flex-grow-1">
                                <input type="text" class="form-control form-control-sm border-0 fw-bold"
                                       v-model="content.blocks[currentPageIndex].data.filename"
                                       placeholder="íŒŒì¼ëª…">
                                <small class="text-muted">{{ content.blocks[currentPageIndex].data.size }}</small>
                            </div>
                            <button class="btn btn-sm btn-outline-danger"
                                    @click="content.blocks[currentPageIndex].data.url = ''">
                                ì œê±°
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì‚¬ì´ë“œë°” - ë¯¸ë¦¬ë³´ê¸° ë° ë„ì›€ë§ -->
        <div class="col-lg-3">
            <!-- í•™ìŠµì ë·° ë¯¸ë¦¬ë³´ê¸° -->
            <div v-if="content.blocks.length > 0 && content.blocks[currentPageIndex]" class="card border-0 shadow-sm mb-3">
                <div class="card-header bg-primary text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <small>í•™ìŠµì í™”ë©´ ë¯¸ë¦¬ë³´ê¸°</small>
                        <small>{{ currentPageIndex + 1 }} / {{ content.blocks.length }}</small>
                    </div>
                </div>
                <div class="card-body">
                    <h6 class="mb-3">{{ content.title || 'ì œëª© ì—†ìŒ' }}</h6>

                    <!-- ë¯¸ë¦¬ë³´ê¸°: í…ìŠ¤íŠ¸ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'text'">
                        <h1 v-if="content.blocks[currentPageIndex].data.style === 'h1'" class="preview-text">{{ content.blocks[currentPageIndex].data.content || 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”' }}</h1>
                        <h2 v-else-if="content.blocks[currentPageIndex].data.style === 'h2'" class="preview-text">{{ content.blocks[currentPageIndex].data.content || 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”' }}</h2>
                        <h3 v-else-if="content.blocks[currentPageIndex].data.style === 'h3'" class="preview-text">{{ content.blocks[currentPageIndex].data.content || 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”' }}</h3>
                        <p v-else style="white-space: pre-wrap;">{{ content.blocks[currentPageIndex].data.content || 'í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”' }}</p>
                    </div>

                    <!-- ë¯¸ë¦¬ë³´ê¸°: ì´ë¯¸ì§€ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'image'">
                        <div v-if="content.blocks[currentPageIndex].data.url">
                            <img :src="content.blocks[currentPageIndex].data.url" class="img-fluid rounded" :alt="content.blocks[currentPageIndex].data.caption">
                            <p class="text-muted small mt-2" v-if="content.blocks[currentPageIndex].data.caption">{{ content.blocks[currentPageIndex].data.caption }}</p>
                        </div>
                        <div v-else class="text-center text-muted py-3">
                            <i class="bi bi-image fs-1"></i>
                            <p class="small mt-2">ì´ë¯¸ì§€ ì—†ìŒ</p>
                        </div>
                    </div>

                    <!-- ë¯¸ë¦¬ë³´ê¸°: ë¹„ë””ì˜¤ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'video'">
                        <div v-if="content.blocks[currentPageIndex].data.url">
                            <div class="ratio ratio-16x9">
                                <iframe v-if="content.blocks[currentPageIndex].data.provider === 'youtube'"
                                        :src="getYoutubeEmbedUrl(content.blocks[currentPageIndex].data.url)"
                                        allowfullscreen></iframe>
                                <iframe v-else-if="content.blocks[currentPageIndex].data.provider === 'vimeo'"
                                        :src="getVimeoEmbedUrl(content.blocks[currentPageIndex].data.url)"
                                        allowfullscreen></iframe>
                                <video v-else :src="content.blocks[currentPageIndex].data.url" controls class="w-100"></video>
                            </div>
                        </div>
                        <div v-else class="text-center text-muted py-3">
                            <i class="bi bi-camera-video fs-1"></i>
                            <p class="small mt-2">ë¹„ë””ì˜¤ ì—†ìŒ</p>
                        </div>
                    </div>

                    <!-- ë¯¸ë¦¬ë³´ê¸°: í€´ì¦ˆ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'quiz'">
                        <p class="fw-bold mb-3">{{ content.blocks[currentPageIndex].data.question || 'ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”' }}</p>
                        <div v-if="content.blocks[currentPageIndex].data.quizType === 'multiple' || content.blocks[currentPageIndex].data.quizType === 'checkbox'">
                            <div v-for="(option, idx) in content.blocks[currentPageIndex].data.options" :key="idx" class="form-check mb-2">
                                <input class="form-check-input"
                                       :type="content.blocks[currentPageIndex].data.quizType === 'multiple' ? 'radio' : 'checkbox'"
                                       :name="'quiz-preview-' + currentPageIndex"
                                       :id="'option-preview-' + currentPageIndex + '-' + idx"
                                       disabled>
                                <label class="form-check-label" :for="'option-preview-' + currentPageIndex + '-' + idx">
                                    {{ option.text || 'ì„ íƒì§€ ' + (idx + 1) }}
                                </label>
                            </div>
                        </div>
                        <div v-else-if="content.blocks[currentPageIndex].data.quizType === 'short'">
                            <input type="text" class="form-control" placeholder="ë‹µì„ ì…ë ¥í•˜ì„¸ìš”" disabled>
                        </div>
                        <div v-else-if="content.blocks[currentPageIndex].data.quizType === 'essay'">
                            <textarea class="form-control" rows="4" placeholder="ë‹µì„ ì…ë ¥í•˜ì„¸ìš”" disabled></textarea>
                        </div>
                    </div>

                    <!-- ë¯¸ë¦¬ë³´ê¸°: ì½”ë“œ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'code'">
                        <div class="bg-dark text-light p-3 rounded">
                            <small class="text-muted">{{ content.blocks[currentPageIndex].data.language }}</small>
                            <pre class="mb-0 mt-2 text-light"><code>{{ content.blocks[currentPageIndex].data.code || 'ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”' }}</code></pre>
                        </div>
                    </div>

                    <!-- ë¯¸ë¦¬ë³´ê¸°: íŒŒì¼ -->
                    <div v-if="content.blocks[currentPageIndex].type === 'file'">
                        <div v-if="content.blocks[currentPageIndex].data.url" class="border rounded p-3">
                            <i class="bi bi-file-earmark-arrow-down text-primary fs-4"></i>
                            <span class="ms-2">{{ content.blocks[currentPageIndex].data.filename }}</span>
                            <span class="text-muted small ms-2">({{ content.blocks[currentPageIndex].data.size }})</span>
                        </div>
                        <div v-else class="text-center text-muted py-3">
                            <i class="bi bi-file-earmark fs-1"></i>
                            <p class="small mt-2">íŒŒì¼ ì—†ìŒ</p>
                        </div>
                    </div>

                    <!-- ë‹¤ìŒ ë²„íŠ¼ / í•™ìŠµì™„ë£Œ ë²„íŠ¼ -->
                    <div class="text-center mt-3">
                        <button v-if="currentPageIndex < content.blocks.length - 1" class="btn btn-primary" disabled>
                            ë‹¤ìŒ <i class="bi bi-arrow-right"></i>
                        </button>
                        <button v-else class="btn btn-success" disabled>
                            <i class="bi bi-check-circle"></i> í•™ìŠµì™„ë£Œ
                        </button>
                    </div>
                </div>
            </div>

            <!-- ë„ì›€ë§ -->
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h6 class="mb-2">ğŸ’¡ ì €ì‘ë„êµ¬ ê°€ì´ë“œ</h6>
                    <ul class="small text-muted mb-0 ps-3">
                        <li class="mb-1">ê° í˜ì´ì§€ê°€ í•˜ë‚˜ì˜ í•™ìŠµ ë‹¨ìœ„</li>
                        <li class="mb-1">í•™ìŠµìëŠ” í˜ì´ì§€ë³„ë¡œ ì§„í–‰</li>
                        <li class="mb-1">í€´ì¦ˆë¡œ ì´í•´ë„ í™•ì¸</li>
                        <li class="mb-1">ìš°ì¸¡ì—ì„œ ì‹¤ì‹œê°„ ë¯¸ë¦¬ë³´ê¸°</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- ë¯¸ë¦¬ë³´ê¸° ëª¨ë‹¬ (ì „ì²´ ì½˜í…ì¸ ) -->
    <div class="modal fade" id="previewModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">{{ content.title || 'ì œëª© ì—†ìŒ' }}</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted" v-if="content.description">{{ content.description }}</p>
                    <div class="alert alert-info">
                        ì´ {{ content.blocks.length }}ê°œ í˜ì´ì§€
                    </div>

                    <div v-for="(block, index) in content.blocks" :key="block.id" class="mb-4 p-3 border rounded">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <strong>í˜ì´ì§€ {{ index + 1 }}</strong>
                            <span class="badge bg-secondary">{{ getBlockTypeLabel(block.type) }}</span>
                        </div>

                        <!-- ë¯¸ë¦¬ë³´ê¸° ë‚´ìš© (ëª¨ë‹¬ìš©) -->
                        <div v-if="block.type === 'text'">
                            <h1 v-if="block.data.style === 'h1'">{{ block.data.content }}</h1>
                            <h2 v-else-if="block.data.style === 'h2'">{{ block.data.content }}</h2>
                            <h3 v-else-if="block.data.style === 'h3'">{{ block.data.content }}</h3>
                            <p v-else style="white-space: pre-wrap;">{{ block.data.content }}</p>
                        </div>

                        <div v-if="block.type === 'image' && block.data.url">
                            <img :src="block.data.url" class="img-fluid rounded" :alt="block.data.caption">
                            <p class="text-muted small mt-2" v-if="block.data.caption">{{ block.data.caption }}</p>
                        </div>

                        <div v-if="block.type === 'video' && block.data.url">
                            <div class="ratio ratio-16x9">
                                <iframe v-if="block.data.provider === 'youtube'"
                                        :src="getYoutubeEmbedUrl(block.data.url)"
                                        allowfullscreen></iframe>
                                <iframe v-else-if="block.data.provider === 'vimeo'"
                                        :src="getVimeoEmbedUrl(block.data.url)"
                                        allowfullscreen></iframe>
                                <video v-else :src="block.data.url" controls class="w-100"></video>
                            </div>
                        </div>

                        <div v-if="block.type === 'quiz'" class="border rounded p-3 bg-light">
                            <p class="fw-bold mb-3">{{ block.data.question }}</p>
                            <div v-if="block.data.quizType === 'multiple' || block.data.quizType === 'checkbox'">
                                <div v-for="(option, idx) in block.data.options" :key="idx" class="form-check mb-2">
                                    <input class="form-check-input"
                                           :type="block.data.quizType === 'multiple' ? 'radio' : 'checkbox'"
                                           :name="'quiz-modal-' + block.id"
                                           :id="'option-modal-' + block.id + '-' + idx">
                                    <label class="form-check-label" :for="'option-modal-' + block.id + '-' + idx">
                                        {{ option.text }}
                                    </label>
                                </div>
                            </div>
                            <div v-else-if="block.data.quizType === 'short'">
                                <input type="text" class="form-control" placeholder="ë‹µì„ ì…ë ¥í•˜ì„¸ìš”">
                            </div>
                            <div v-else-if="block.data.quizType === 'essay'">
                                <textarea class="form-control" rows="4" placeholder="ë‹µì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
                            </div>
                        </div>

                        <div v-if="block.type === 'code'">
                            <div class="bg-dark text-light p-3 rounded">
                                <small class="text-muted">{{ block.data.language }}</small>
                                <pre class="mb-0 mt-2"><code>{{ block.data.code }}</code></pre>
                            </div>
                        </div>

                        <div v-if="block.type === 'file' && block.data.url" class="border rounded p-3">
                            <i class="bi bi-file-earmark-arrow-down text-primary fs-4"></i>
                            <span class="ms-2">{{ block.data.filename }}</span>
                            <span class="text-muted small ms-2">({{ block.data.size }})</span>
                        </div>

                        <div class="text-center mt-3">
                            <button v-if="index < content.blocks.length - 1" class="btn btn-sm btn-primary" disabled>
                                ë‹¤ìŒ <i class="bi bi-arrow-right"></i>
                            </button>
                            <button v-else class="btn btn-sm btn-success" disabled>
                                <i class="bi bi-check-circle"></i> í•™ìŠµì™„ë£Œ
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.content-author-page .text-style-h1 {
    font-size: 2rem;
    font-weight: bold;
}
.content-author-page .text-style-h2 {
    font-size: 1.5rem;
    font-weight: bold;
}
.content-author-page .text-style-h3 {
    font-size: 1.25rem;
    font-weight: bold;
}
.content-author-page .preview-text {
    font-size: 0.8em;
}
</style>

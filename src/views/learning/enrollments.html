<div class="enrollments-page">
    <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">ÏàòÍ∞ï Í¥ÄÎ¶¨</h4>
            <p class="text-muted mb-0">ÏàòÍ∞ï Ïã†Ï≤≠ÏùÑ ÏäπÏù∏ÌïòÍ≥† ÏàòÍ∞ïÏÉùÏùÑ Î∞∞Ï†ïÌï©ÎãàÎã§</p>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-outline-primary" @click="openBulkAssign">
                üë• ÏùºÍ¥Ñ Î∞∞Ï†ï
            </button>
            <button class="btn btn-primary" @click="openAssignModal">
                <span class="me-1">‚ûï</span> ÏàòÍ∞ï Î∞∞Ï†ï
            </button>
        </div>
    </div>

    <!-- ÌÜµÍ≥Ñ Ïπ¥Îìú -->
    <div class="row g-3 mb-4">
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="fs-4 fw-bold text-warning">{{ stats.pending }}</div>
                    <div class="text-muted small">ÏäπÏù∏ ÎåÄÍ∏∞</div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="fs-4 fw-bold text-primary">{{ stats.active }}</div>
                    <div class="text-muted small">ÏàòÍ∞ïÏ§ë</div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="fs-4 fw-bold text-success">{{ stats.completed }}</div>
                    <div class="text-muted small">ÏàòÎ£å ÏôÑÎ£å</div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center">
                    <div class="fs-4 fw-bold text-danger">{{ stats.expired }}</div>
                    <div class="text-muted small">Í∏∞Í∞Ñ ÎßåÎ£å</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌÉ≠ Î©îÎâ¥ -->
    <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'pending' }" href="#" @click.prevent="activeTab = 'pending'">
                ÏäπÏù∏ ÎåÄÍ∏∞ <span class="badge bg-warning text-dark ms-1">{{ stats.pending }}</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'all' }" href="#" @click.prevent="activeTab = 'all'">
                Ï†ÑÏ≤¥ ÏàòÍ∞ï
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'voucher' }" href="#" @click.prevent="activeTab = 'voucher'">
                ÏàòÍ∞ïÍ∂å Í¥ÄÎ¶¨
            </a>
        </li>
    </ul>

    <!-- ÏäπÏù∏ ÎåÄÍ∏∞ ÌÉ≠ -->
    <div v-if="activeTab === 'pending'">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th><input type="checkbox" class="form-check-input"></th>
                                <th>Ïã†Ï≤≠Ïûê</th>
                                <th>Í∞ïÏ¢å</th>
                                <th>Ïã†Ï≤≠Ïùº</th>
                                <th>Í≤∞Ï†ú ÏÉÅÌÉú</th>
                                <th style="width: 150px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="req in pendingRequests" :key="req.id">
                                <td><input type="checkbox" class="form-check-input"></td>
                                <td>
                                    <div class="fw-medium">{{ req.learner }}</div>
                                    <small class="text-muted">{{ req.email }}</small>
                                </td>
                                <td>{{ req.course }}</td>
                                <td>{{ req.requestDate }}</td>
                                <td>
                                    <span class="badge" :class="req.paid ? 'bg-success' : 'bg-warning text-dark'">
                                        {{ req.paid ? 'Í≤∞Ï†úÏôÑÎ£å' : 'Í≤∞Ï†úÎåÄÍ∏∞' }}
                                    </span>
                                </td>
                                <td>
                                    <button class="btn btn-sm btn-success me-1" @click="approve(req)">ÏäπÏù∏</button>
                                    <button class="btn btn-sm btn-outline-danger" @click="reject(req)">Í±∞Ï†à</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Ï†ÑÏ≤¥ ÏàòÍ∞ï ÌÉ≠ -->
    <div v-if="activeTab === 'all'">
        <div class="card border-0 shadow-sm mb-3">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-3">
                        <select class="form-select" v-model="filters.course">
                            <option value="">Ï†ÑÏ≤¥ Í∞ïÏ¢å</option>
                            <option v-for="c in courseList" :key="c">{{ c }}</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <select class="form-select" v-model="filters.status">
                            <option value="">Ï†ÑÏ≤¥ ÏÉÅÌÉú</option>
                            <option value="active">ÏàòÍ∞ïÏ§ë</option>
                            <option value="completed">ÏàòÎ£å</option>
                            <option value="expired">ÎßåÎ£å</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <input type="text" class="form-control" placeholder="ÌïôÏäµÏûê Í≤ÄÏÉâ..." v-model="searchQuery">
                    </div>
                </div>
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ÌïôÏäµÏûê</th>
                                <th>Í∞ïÏ¢å</th>
                                <th class="text-center">ÏßÑÎèÑÏú®</th>
                                <th>ÏàòÍ∞ï Í∏∞Í∞Ñ</th>
                                <th class="text-center">ÏÉÅÌÉú</th>
                                <th style="width: 100px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="enroll in enrollments" :key="enroll.id">
                                <td>
                                    <div class="fw-medium">{{ enroll.learner }}</div>
                                    <small class="text-muted">{{ enroll.email }}</small>
                                </td>
                                <td>{{ enroll.course }}</td>
                                <td class="text-center">
                                    <div class="d-flex align-items-center justify-content-center">
                                        <div class="progress me-2" style="width: 60px; height: 6px;">
                                            <div class="progress-bar" :style="{ width: enroll.progress + '%' }"></div>
                                        </div>
                                        <span class="small">{{ enroll.progress }}%</span>
                                    </div>
                                </td>
                                <td>
                                    <div class="small">{{ enroll.startDate }} ~ {{ enroll.endDate }}</div>
                                </td>
                                <td class="text-center">
                                    <span class="badge" :class="getEnrollStatusClass(enroll.status)">
                                        {{ getEnrollStatusText(enroll.status) }}
                                    </span>
                                </td>
                                <td>
                                    <div class="dropdown">
                                        <button class="btn btn-link text-muted p-0" data-bs-toggle="dropdown">‚ãÆ</button>
                                        <ul class="dropdown-menu dropdown-menu-end">
                                            <li><a class="dropdown-item" href="#" @click="extendPeriod(enroll)">üìÖ Í∏∞Í∞Ñ Ïó∞Ïû•</a></li>
                                            <li><a class="dropdown-item" href="#" @click="resetProgress(enroll)">üîÑ ÏßÑÎèÑ Ï¥àÍ∏∞Ìôî</a></li>
                                            <li><hr class="dropdown-divider"></li>
                                            <li><a class="dropdown-item text-danger" href="#" @click="cancelEnroll(enroll)">‚ùå ÏàòÍ∞ï Ï∑®ÏÜå</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏàòÍ∞ïÍ∂å Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div v-if="activeTab === 'voucher'">
        <div class="d-flex justify-content-end mb-3">
            <button class="btn btn-primary" @click="createVoucher">
                <span class="me-1">üé´</span> ÏàòÍ∞ïÍ∂å Î∞úÍ∏â
            </button>
        </div>
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ÏàòÍ∞ïÍ∂å ÏΩîÎìú</th>
                                <th>Í∞ïÏ¢å</th>
                                <th>ÏàòÍ∞ï Í∏∞Í∞Ñ</th>
                                <th>Î∞úÍ∏âÏùº</th>
                                <th>ÎßåÎ£åÏùº</th>
                                <th class="text-center">ÏÇ¨Ïö© Ïó¨Î∂Ä</th>
                                <th style="width: 80px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="voucher in vouchers" :key="voucher.id">
                                <td><code>{{ voucher.code }}</code></td>
                                <td>{{ voucher.course }}</td>
                                <td>{{ voucher.duration }}</td>
                                <td>{{ voucher.issuedDate }}</td>
                                <td>{{ voucher.expiryDate }}</td>
                                <td class="text-center">
                                    <span class="badge" :class="voucher.used ? 'bg-secondary' : 'bg-success'">
                                        {{ voucher.used ? 'ÏÇ¨Ïö©Îê®' : 'ÎØ∏ÏÇ¨Ïö©' }}
                                    </span>
                                </td>
                                <td>
                                    <button class="btn btn-sm btn-outline-danger" @click="deleteVoucher(voucher)" :disabled="voucher.used">
                                        ÏÇ≠Ï†ú
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

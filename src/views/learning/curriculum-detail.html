<div class="curriculum-detail-page">
    <!-- 페이지 헤더 -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <div class="d-flex align-items-center gap-2 mb-2">
                <a href="#" @click.prevent="navigateTo('/learning/curriculum')" class="text-muted">
                    ← 커리큘럼 목록
                </a>
            </div>
            <h4 class="mb-1">{{ curriculum?.name }}</h4>
            <p class="text-muted mb-0">커리큘럼 상세 정보</p>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-outline-secondary" @click="edit">
                수정
            </button>
            <button class="btn btn-outline-danger" @click="deleteCurriculum">
                삭제
            </button>
        </div>
    </div>

    <!-- 탭 메뉴 -->
    <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link" :class="{ active: currentTab === 'info' }" href="#" @click.prevent="currentTab = 'info'">기본정보</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: currentTab === 'lessons' }" href="#" @click.prevent="currentTab = 'lessons'">차시 목록</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: currentTab === 'progress' }" href="#" @click.prevent="currentTab = 'progress'">수강생 진도</a>
        </li>
    </ul>

    <!-- 기본정보 탭 -->
    <div v-if="currentTab === 'info' && curriculum">
        <div class="row">
            <div class="col-lg-8">
                <div class="card border-0 shadow-sm">
                    <div class="card-header bg-white border-bottom">
                        <h5 class="mb-0">커리큘럼 정보</h5>
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <label class="form-label text-muted small">커리큘럼명</label>
                                <div class="fw-medium">{{ curriculum.name }}</div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label text-muted small">연결 강좌</label>
                                <div class="fw-medium">{{ curriculum.courseName }}</div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label text-muted small">총 차시</label>
                                <div class="fw-medium">{{ curriculum.totalLessons }}개</div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label text-muted small">총 시간</label>
                                <div class="fw-medium">{{ curriculum.totalDuration }}</div>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label text-muted small">상태</label>
                                <div>
                                    <span class="badge" :class="getStatusClass(curriculum.status)">
                                        {{ getStatusText(curriculum.status) }}
                                    </span>
                                </div>
                            </div>
                            <div class="col-12">
                                <label class="form-label text-muted small">설명</label>
                                <div class="fw-medium">{{ curriculum.description }}</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 통계 사이드바 -->
            <div class="col-lg-4">
                <div class="card border-0 shadow-sm">
                    <div class="card-body">
                        <h6 class="mb-3">커리큘럼 통계</h6>
                        <div class="d-flex justify-content-between mb-2">
                            <span class="small text-muted">수강생</span>
                            <span class="fw-bold fs-5">{{ curriculum.students }}명</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span class="small text-muted">평균 진도율</span>
                            <span class="fw-bold">{{ curriculum.avgProgress }}%</span>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span class="small text-muted">완료율</span>
                            <span class="fw-bold">{{ curriculum.completionRate }}%</span>
                        </div>
                        <hr>
                        <div class="d-flex justify-content-between">
                            <span class="small text-muted">생성일</span>
                            <span class="fw-medium">{{ curriculum.createdAt }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 차시 목록 탭 -->
    <div v-if="currentTab === 'lessons'">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-bottom d-flex justify-content-between align-items-center">
                <h5 class="mb-0">차시 목록</h5>
                <button class="btn btn-sm btn-primary" @click="addLesson">
                    + 차시 추가
                </button>
            </div>
            <div class="card-body">
                <div class="list-group">
                    <div class="list-group-item" v-for="(lesson, index) in lessons" :key="lesson.id">
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center gap-3">
                                <div class="drag-handle text-muted" style="cursor: move;">
                                    ⋮⋮
                                </div>
                                <span class="badge bg-light text-dark">{{ index + 1 }}</span>
                                <div>
                                    <div class="fw-medium">{{ lesson.title }}</div>
                                    <small class="text-muted">
                                        {{ lesson.duration }} |
                                        <span :class="lesson.contentId ? 'text-success' : 'text-warning'">
                                            {{ lesson.contentId ? '콘텐츠 연결됨' : '콘텐츠 미연결' }}
                                        </span>
                                    </small>
                                </div>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-outline-primary" @click="viewLesson(lesson)">상세</button>
                                <button class="btn btn-sm btn-outline-secondary" @click="editLesson(lesson)">수정</button>
                                <button class="btn btn-sm btn-outline-danger" @click="deleteLesson(lesson)">삭제</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 수강생 진도 탭 -->
    <div v-if="currentTab === 'progress'">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-white border-bottom">
                <h5 class="mb-0">수강생별 진도 현황</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>이름</th>
                                <th>이메일</th>
                                <th class="text-center">진도율</th>
                                <th class="text-center">완료 차시</th>
                                <th>마지막 학습일</th>
                                <th class="text-center">상태</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="student in studentProgress" :key="student.id">
                                <td>{{ student.name }}</td>
                                <td>{{ student.email }}</td>
                                <td class="text-center">
                                    <div class="progress" style="height: 8px; width: 100px; margin: 0 auto;">
                                        <div class="progress-bar" :style="{ width: student.progress + '%' }"></div>
                                    </div>
                                    <small class="text-muted">{{ student.progress }}%</small>
                                </td>
                                <td class="text-center">{{ student.completedLessons }}/{{ curriculum.totalLessons }}</td>
                                <td>{{ student.lastStudyDate }}</td>
                                <td class="text-center">
                                    <span class="badge" :class="student.progress === 100 ? 'bg-success' : 'bg-primary'">
                                        {{ student.progress === 100 ? '완료' : '진행중' }}
                                    </span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

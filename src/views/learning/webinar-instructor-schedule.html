<div class="webinar-instructor-schedule">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">Í∞ïÏÇ¨ Ïä§ÏºÄÏ§Ñ Í¥ÄÎ¶¨</h4>
            <p class="text-muted mb-0">Í∞ïÏÇ¨Î≥Ñ Í∞ÄÏö© ÏãúÍ∞ÑÏùÑ ÏÑ§Ï†ïÌïòÍ≥† ÏòàÏô∏ ÎÇ†ÏßúÎ•º Í¥ÄÎ¶¨Ìï©ÎãàÎã§</p>
        </div>
        <button class="btn btn-primary" @click="saveSchedule" v-if="selectedInstructor">
            <span class="me-1">üíæ</span> Ï†ÄÏû•
        </button>
    </div>

    <div class="row g-4">
        <!-- Í∞ïÏÇ¨ Î™©Î°ù -->
        <div class="col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <h6 class="mb-0">Í∞ïÏÇ¨ Î™©Î°ù</h6>
                </div>
                <div class="card-body p-0">
                    <div class="list-group list-group-flush">
                        <a
                            v-for="instructor in instructors"
                            :key="instructor.id"
                            class="list-group-item list-group-item-action"
                            :class="{ active: selectedInstructor && selectedInstructor.id === instructor.id }"
                            @click="selectInstructor(instructor)"
                            role="button"
                        >
                            <div class="d-flex align-items-center">
                                <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center me-2" style="width: 36px; height: 36px;">
                                    <span class="small">{{ instructor.name.charAt(0) }}</span>
                                </div>
                                <div class="flex-fill">
                                    <div class="fw-bold">{{ instructor.name }}</div>
                                    <div class="small text-muted">{{ instructor.department }}</div>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ïä§ÏºÄÏ§Ñ ÏÑ§Ï†ï -->
        <div class="col-lg-9" v-if="selectedInstructor && currentSchedule">
            <div class="card border-0 shadow-sm mb-4">
                <div class="card-header bg-white border-bottom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">Ï£ºÍ∞Ñ Î∞òÎ≥µ Ïä§ÏºÄÏ§Ñ</h6>
                        <button class="btn btn-sm btn-primary" @click="openAddSlotModal">
                            <span class="me-1">‚ûï</span> ÏãúÍ∞Ñ Ï∂îÍ∞Ä
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label class="form-label">Ïä¨Î°Ø Îã®ÏúÑ (Î∂Ñ)</label>
                        <select class="form-select" v-model="currentSchedule.slotDuration" style="max-width: 200px;">
                            <option :value="30">30Î∂Ñ</option>
                            <option :value="60">60Î∂Ñ</option>
                            <option :value="90">90Î∂Ñ</option>
                            <option :value="120">120Î∂Ñ</option>
                        </select>
                    </div>

                    <div class="table-responsive">
                        <table class="table">
                            <thead class="table-light">
                                <tr>
                                    <th style="width: 120px;">ÏöîÏùº</th>
                                    <th>Í∞ÄÏö© ÏãúÍ∞Ñ</th>
                                    <th style="width: 100px;"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="(dayKey, index) in Object.keys(currentSchedule.weeklySchedule)" :key="dayKey">
                                    <td class="fw-bold">{{ dayNames[dayKey] }}</td>
                                    <td>
                                        <div v-if="currentSchedule.weeklySchedule[dayKey].length === 0" class="text-muted">
                                            ÏÑ§Ï†ïÎêú ÏãúÍ∞Ñ ÏóÜÏùå
                                        </div>
                                        <div v-else>
                                            <span
                                                v-for="(slot, slotIndex) in currentSchedule.weeklySchedule[dayKey]"
                                                :key="slotIndex"
                                                class="badge bg-success me-2 mb-1"
                                            >
                                                {{ slot.startTime }} - {{ slot.endTime }}
                                                <button
                                                    class="btn-close btn-close-white ms-2"
                                                    style="font-size: 0.6rem;"
                                                    @click="removeTimeSlot(dayKey, slotIndex)"
                                                ></button>
                                            </span>
                                        </div>
                                    </td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ÏòàÏô∏ ÎÇ†Ïßú -->
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">ÏòàÏô∏ ÎÇ†Ïßú (Ìú¥Í∞Ä, Í≥µÌú¥Ïùº Îì±)</h6>
                        <button class="btn btn-sm btn-primary" @click="openAddExceptionModal">
                            <span class="me-1">‚ûï</span> ÏòàÏô∏ Ï∂îÍ∞Ä
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div v-if="getInstructorExceptions().length === 0" class="text-center text-muted py-4">
                        Îì±Î°ùÎêú ÏòàÏô∏ ÎÇ†ÏßúÍ∞Ä ÏóÜÏäµÎãàÎã§
                    </div>
                    <div v-else class="table-responsive">
                        <table class="table">
                            <thead class="table-light">
                                <tr>
                                    <th>ÎÇ†Ïßú</th>
                                    <th>ÏãúÍ∞Ñ</th>
                                    <th>Ïú†Ìòï</th>
                                    <th>ÏÇ¨Ïú†</th>
                                    <th style="width: 100px;"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr v-for="exception in getInstructorExceptions()" :key="exception.id">
                                    <td>{{ formatDate(exception.date) }}</td>
                                    <td>
                                        <span v-if="exception.isAllDay" class="text-muted">ÌïòÎ£® Ï¢ÖÏùº</span>
                                        <span v-else class="fw-bold">{{ exception.startTime }} - {{ exception.endTime }}</span>
                                    </td>
                                    <td>
                                        <span class="badge" :class="exception.type === 'holiday' ? 'bg-danger' : 'bg-warning'">
                                            {{ exception.type === 'holiday' ? 'Í≥µÌú¥Ïùº' : 'Î∂àÍ∞Ä' }}
                                        </span>
                                    </td>
                                    <td>{{ exception.reason }}</td>
                                    <td>
                                        <button class="btn btn-sm btn-outline-danger" @click="removeException(exception.id)">
                                            ÏÇ≠Ï†ú
                                        </button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-lg-9" v-else-if="!selectedInstructor">
            <div class="card border-0 shadow-sm">
                <div class="card-body text-center py-5">
                    <div class="fs-1 mb-3">üëà</div>
                    <h5 class="text-muted">Í∞ïÏÇ¨Î•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</h5>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏãúÍ∞Ñ Ïä¨Î°Ø Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div v-if="showAddSlotModal" class="modal d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ÏãúÍ∞Ñ Ïä¨Î°Ø Ï∂îÍ∞Ä</h5>
                    <button type="button" class="btn-close" @click="showAddSlotModal = false"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">ÏöîÏùº</label>
                        <select class="form-select" v-model="newTimeSlot.day">
                            <option v-for="(name, key) in dayNames" :key="key" :value="key">{{ name }}</option>
                        </select>
                    </div>
                    <div class="row">
                        <div class="col-6 mb-3">
                            <label class="form-label">ÏãúÏûë ÏãúÍ∞Ñ</label>
                            <input type="time" class="form-control" v-model="newTimeSlot.startTime">
                        </div>
                        <div class="col-6 mb-3">
                            <label class="form-label">Ï¢ÖÎ£å ÏãúÍ∞Ñ</label>
                            <input type="time" class="form-control" v-model="newTimeSlot.endTime">
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" @click="showAddSlotModal = false">Ï∑®ÏÜå</button>
                    <button type="button" class="btn btn-primary" @click="addTimeSlot">Ï∂îÍ∞Ä</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏòàÏô∏ ÎÇ†Ïßú Ï∂îÍ∞Ä Î™®Îã¨ -->
    <div v-if="showAddExceptionModal" class="modal d-block" tabindex="-1" style="background: rgba(0,0,0,0.5);">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">ÏòàÏô∏ ÎÇ†Ïßú Ï∂îÍ∞Ä</h5>
                    <button type="button" class="btn-close" @click="showAddExceptionModal = false"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">ÎÇ†Ïßú</label>
                        <input type="date" class="form-control" v-model="newException.date">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Ïú†Ìòï</label>
                        <select class="form-select" v-model="newException.type">
                            <option value="unavailable">Î∂àÍ∞Ä</option>
                            <option value="holiday">Í≥µÌú¥Ïùº</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Í∏∞Í∞Ñ</label>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" v-model="newException.isAllDay" id="isAllDay">
                            <label class="form-check-label" for="isAllDay">
                                ÌïòÎ£® Ï¢ÖÏùº
                            </label>
                        </div>
                    </div>
                    <div v-if="!newException.isAllDay" class="mb-3">
                        <div class="row g-3">
                            <div class="col-6">
                                <label class="form-label">ÏãúÏûë ÏãúÍ∞Ñ</label>
                                <input type="time" class="form-control" v-model="newException.startTime">
                            </div>
                            <div class="col-6">
                                <label class="form-label">Ï¢ÖÎ£å ÏãúÍ∞Ñ</label>
                                <input type="time" class="form-control" v-model="newException.endTime">
                            </div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">ÏÇ¨Ïú†</label>
                        <input type="text" class="form-control" v-model="newException.reason" placeholder="Ïòà: Í∞úÏù∏ ÏùºÏ†ï, ÏÑ§ÎÇ† Ïó∞Ìú¥, Î≥ëÏõê ÏßÑÎ£å">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" @click="showAddExceptionModal = false">Ï∑®ÏÜå</button>
                    <button type="button" class="btn btn-primary" @click="addException">Ï∂îÍ∞Ä</button>
                </div>
            </div>
        </div>
    </div>
</div>

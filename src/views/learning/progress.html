<div class="progress-page">
    <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">ÌïôÏäµ ÌòÑÌô©</h4>
            <p class="text-muted mb-0">ÌïôÏäµÏûêÏùò ÏßÑÎèÑ, ÏÑ±Ï†Å, Ï∂úÏÑù, ÏàòÎ£å ÌòÑÌô©ÏùÑ ÌôïÏù∏Ìï©ÎãàÎã§</p>
        </div>
        <button class="btn btn-outline-primary" @click="exportReport">
            üìä Î¶¨Ìè¨Ìä∏ ÎÇ¥Î≥¥ÎÇ¥Í∏∞
        </button>
    </div>

    <!-- ÌÉ≠ Î©îÎâ¥ -->
    <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'progress' }" href="#" @click.prevent="activeTab = 'progress'">
                üìà ÏßÑÎèÑ Í¥ÄÎ¶¨
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'grades' }" href="#" @click.prevent="activeTab = 'grades'">
                üìã ÏÑ±Ï†Å Í¥ÄÎ¶¨
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'attendance' }" href="#" @click.prevent="activeTab = 'attendance'">
                üìÖ Ï∂úÏÑù Í¥ÄÎ¶¨
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'completion' }" href="#" @click.prevent="activeTab = 'completion'">
                üéì ÏàòÎ£å Í¥ÄÎ¶¨
            </a>
        </li>
    </ul>

    <!-- ÏßÑÎèÑ Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div v-if="activeTab === 'progress'">
        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <select class="form-select" v-model="filters.course">
                    <option value="">Ï†ÑÏ≤¥ Í∞ïÏ¢å</option>
                    <option v-for="c in courseList" :key="c">{{ c }}</option>
                </select>
            </div>
            <div class="col-md-4">
                <select class="form-select" v-model="filters.progressRange">
                    <option value="">Ï†ÑÏ≤¥ ÏßÑÎèÑÏú®</option>
                    <option value="0-25">0% ~ 25%</option>
                    <option value="26-50">26% ~ 50%</option>
                    <option value="51-75">51% ~ 75%</option>
                    <option value="76-100">76% ~ 100%</option>
                </select>
            </div>
            <div class="col-md-4">
                <input type="text" class="form-control" placeholder="ÌïôÏäµÏûê Í≤ÄÏÉâ..." v-model="searchQuery">
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ÌïôÏäµÏûê</th>
                                <th>Í∞ïÏ¢å</th>
                                <th>ÏßÑÎèÑÏú®</th>
                                <th class="text-center">ÏôÑÎ£å Ï∞®Ïãú</th>
                                <th class="text-center">Ï¥ù ÌïôÏäµÏãúÍ∞Ñ</th>
                                <th>ÏµúÍ∑º ÌïôÏäµÏùº</th>
                                <th style="width: 80px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="item in progressList" :key="item.id">
                                <td>
                                    <div class="fw-medium" @click="viewDetail(item)" style="cursor: pointer;">{{ item.learner }}</div>
                                    <small class="text-muted">{{ item.email }}</small>
                                </td>
                                <td>{{ item.course }}</td>
                                <td style="width: 200px;">
                                    <div class="d-flex align-items-center">
                                        <div class="progress flex-grow-1 me-2" style="height: 8px;">
                                            <div class="progress-bar" :class="getProgressColor(item.progress)"
                                                 :style="{ width: item.progress + '%' }"></div>
                                        </div>
                                        <span class="small fw-medium">{{ item.progress }}%</span>
                                    </div>
                                </td>
                                <td class="text-center">{{ item.completedLessons }}/{{ item.totalLessons }}</td>
                                <td class="text-center">{{ item.studyTime }}</td>
                                <td>{{ item.lastStudyDate }}</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary" @click="viewDetail(item)">ÏÉÅÏÑ∏</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏÑ±Ï†Å Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div v-if="activeTab === 'grades'">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ÌïôÏäµÏûê</th>
                                <th>Í∞ïÏ¢å</th>
                                <th class="text-center">ÏãúÌóò Ï†êÏàò</th>
                                <th class="text-center">Í≥ºÏ†ú Ï†êÏàò</th>
                                <th class="text-center">Ï∂úÏÑù Ï†êÏàò</th>
                                <th class="text-center">Ï¥ùÏ†ê</th>
                                <th class="text-center">Îì±Í∏â</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="grade in gradeList" :key="grade.id">
                                <td>
                                    <div class="fw-medium">{{ grade.learner }}</div>
                                </td>
                                <td>{{ grade.course }}</td>
                                <td class="text-center">{{ grade.examScore }}</td>
                                <td class="text-center">{{ grade.assignmentScore }}</td>
                                <td class="text-center">{{ grade.attendanceScore }}</td>
                                <td class="text-center fw-bold">{{ grade.totalScore }}</td>
                                <td class="text-center">
                                    <span class="badge" :class="getGradeClass(grade.grade)">{{ grade.grade }}</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Ï∂úÏÑù Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div v-if="activeTab === 'attendance'">
        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <select class="form-select" v-model="filters.course">
                    <option value="">Ï†ÑÏ≤¥ Í∞ïÏ¢å</option>
                    <option v-for="c in courseList" :key="c">{{ c }}</option>
                </select>
            </div>
            <div class="col-md-4">
                <input type="date" class="form-control" v-model="filters.date">
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ÌïôÏäµÏûê</th>
                                <th>Í∞ïÏ¢å</th>
                                <th class="text-center">Ï∂úÏÑùÏùºÏàò</th>
                                <th class="text-center">ÏßÄÍ∞Å</th>
                                <th class="text-center">Í≤∞ÏÑù</th>
                                <th class="text-center">Ï∂úÏÑùÎ•†</th>
                                <th style="width: 100px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="att in attendanceList" :key="att.id">
                                <td><div class="fw-medium">{{ att.learner }}</div></td>
                                <td>{{ att.course }}</td>
                                <td class="text-center text-success">{{ att.present }}Ïùº</td>
                                <td class="text-center text-warning">{{ att.late }}Ïùº</td>
                                <td class="text-center text-danger">{{ att.absent }}Ïùº</td>
                                <td class="text-center fw-bold">{{ att.rate }}%</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-secondary" @click="editAttendance(att)">ÏàòÏ†ï</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏàòÎ£å Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div v-if="activeTab === 'completion'">
        <div class="row g-3 mb-4">
            <div class="col-md-4">
                <select class="form-select" v-model="filters.course">
                    <option value="">Ï†ÑÏ≤¥ Í∞ïÏ¢å</option>
                    <option v-for="c in courseList" :key="c">{{ c }}</option>
                </select>
            </div>
            <div class="col-md-4">
                <select class="form-select" v-model="filters.completionStatus">
                    <option value="">Ï†ÑÏ≤¥</option>
                    <option value="completed">ÏàòÎ£å</option>
                    <option value="pending">ÏàòÎ£å ÏòàÏ†ï</option>
                    <option value="failed">ÎØ∏ÏàòÎ£å</option>
                </select>
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ÌïôÏäµÏûê</th>
                                <th>Í∞ïÏ¢å</th>
                                <th class="text-center">ÏßÑÎèÑÏú®</th>
                                <th class="text-center">Ï¥ùÏ†ê</th>
                                <th class="text-center">ÏàòÎ£å Ïó¨Î∂Ä</th>
                                <th>ÏàòÎ£åÏùº</th>
                                <th style="width: 120px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="comp in completionList" :key="comp.id">
                                <td><div class="fw-medium">{{ comp.learner }}</div></td>
                                <td>{{ comp.course }}</td>
                                <td class="text-center">{{ comp.progress }}%</td>
                                <td class="text-center">{{ comp.totalScore }}Ï†ê</td>
                                <td class="text-center">
                                    <span class="badge" :class="getCompletionClass(comp.status)">
                                        {{ getCompletionText(comp.status) }}
                                    </span>
                                </td>
                                <td>{{ comp.completionDate || '-' }}</td>
                                <td>
                                    <button class="btn btn-sm btn-outline-primary" @click="issueCertificate(comp)"
                                            :disabled="comp.status !== 'completed'">
                                        üèÜ ÏàòÎ£åÏ¶ù
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

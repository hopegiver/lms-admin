<div class="curriculum-page">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">ì»¤ë¦¬í˜ëŸ¼</h4>
            <p class="text-muted mb-0">ê°•ì¢Œì˜ ì°¨ì‹œì™€ ì½˜í…ì¸ ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤</p>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-outline-primary" @click="importScorm">
                ğŸ“¥ SCORM/xAPI ê°€ì ¸ì˜¤ê¸°
            </button>
            <button class="btn btn-primary" @click="addSection">
                <span class="me-1">â•</span> ì„¹ì…˜ ì¶”ê°€
            </button>
        </div>
    </div>

    <div class="row g-4">
        <!-- ê°•ì¢Œ ì„ íƒ -->
        <div class="col-lg-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white">
                    <h6 class="mb-0">ğŸ“š ê°•ì¢Œ ì„ íƒ</h6>
                </div>
                <div class="card-body p-0">
                    <div class="p-3 border-bottom">
                        <input type="text" class="form-control" placeholder="ê°•ì¢Œ ê²€ìƒ‰..." v-model="courseSearch">
                    </div>
                    <div class="list-group list-group-flush" style="max-height: 400px; overflow-y: auto;">
                        <a href="#" class="list-group-item list-group-item-action"
                           v-for="course in filteredCourses" :key="course.id"
                           :class="{ 'active': selectedCourse?.id === course.id }"
                           @click.prevent="selectCourse(course)">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <div class="fw-medium">{{ course.title }}</div>
                                    <small class="text-muted">{{ course.sections }}ê°œ ì„¹ì…˜ Â· {{ course.lessons }}ê°œ ì°¨ì‹œ</small>
                                </div>
                                <span class="badge" :class="course.status === 'published' ? 'bg-success' : 'bg-warning'">
                                    {{ course.status === 'published' ? 'ê³µê°œ' : 'ë¹„ê³µê°œ' }}
                                </span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì»¤ë¦¬í˜ëŸ¼ í¸ì§‘ -->
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm" v-if="selectedCourse">
                <div class="card-header bg-white d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">ğŸ“‹ {{ selectedCourse.title }} - ì»¤ë¦¬í˜ëŸ¼</h6>
                    <button class="btn btn-sm btn-outline-primary" @click="previewCurriculum">ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°</button>
                </div>
                <div class="card-body p-0">
                    <!-- ì„¹ì…˜ ëª©ë¡ -->
                    <div class="curriculum-sections">
                        <div class="section-item border-bottom" v-for="(section, sIndex) in curriculum" :key="section.id">
                            <!-- ì„¹ì…˜ í—¤ë” -->
                            <div class="section-header d-flex align-items-center p-3 bg-light">
                                <span class="me-2 cursor-grab">â‹®â‹®</span>
                                <span class="me-2" @click="toggleSection(section)" style="cursor: pointer;">
                                    {{ section.expanded ? 'â–¼' : 'â–¶' }}
                                </span>
                                <input type="text" class="form-control form-control-sm border-0 bg-transparent fw-bold"
                                       v-model="section.title" style="max-width: 300px;">
                                <span class="badge bg-secondary ms-2">{{ section.lessons.length }}ê°œ ì°¨ì‹œ</span>
                                <div class="ms-auto d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary" @click="addLesson(section)">
                                        â• ì°¨ì‹œ ì¶”ê°€
                                    </button>
                                    <button class="btn btn-sm btn-outline-danger" @click="deleteSection(section)">ğŸ—‘ï¸</button>
                                </div>
                            </div>

                            <!-- ì°¨ì‹œ ëª©ë¡ -->
                            <div class="section-lessons" v-if="section.expanded">
                                <div class="lesson-item d-flex align-items-center p-3 border-bottom"
                                     v-for="(lesson, lIndex) in section.lessons" :key="lesson.id">
                                    <span class="me-2 cursor-grab text-muted">â‹®â‹®</span>
                                    <span class="me-3 text-muted small">{{ sIndex + 1 }}-{{ lIndex + 1 }}</span>
                                    <span class="me-2 fs-5">{{ getLessonIcon(lesson.type) }}</span>
                                    <div class="flex-grow-1">
                                        <input type="text" class="form-control form-control-sm border-0"
                                               v-model="lesson.title" placeholder="ì°¨ì‹œ ì œëª©">
                                    </div>
                                    <span class="badge bg-light text-dark me-2">{{ lesson.duration }}</span>
                                    <div class="form-check form-switch me-2">
                                        <input class="form-check-input" type="checkbox" v-model="lesson.preview" title="ë¬´ë£Œ ë¯¸ë¦¬ë³´ê¸°">
                                    </div>
                                    <div class="dropdown">
                                        <button class="btn btn-sm btn-link text-muted p-0" data-bs-toggle="dropdown">â‹®</button>
                                        <ul class="dropdown-menu dropdown-menu-end">
                                            <li><a class="dropdown-item" href="#" @click="editLesson(lesson)">âœï¸ ìˆ˜ì •</a></li>
                                            <li><a class="dropdown-item" href="#" @click="uploadContent(lesson)">ğŸ“¤ ì½˜í…ì¸  ì—…ë¡œë“œ</a></li>
                                            <li><hr class="dropdown-divider"></li>
                                            <li><a class="dropdown-item text-danger" href="#" @click="deleteLesson(section, lesson)">ğŸ—‘ï¸ ì‚­ì œ</a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ë¹ˆ ìƒíƒœ -->
                    <div class="text-center py-5 text-muted" v-if="curriculum.length === 0">
                        <span class="fs-1">ğŸ“‹</span>
                        <p class="mt-2 mb-3">ì•„ì§ ì»¤ë¦¬í˜ëŸ¼ì´ ì—†ìŠµë‹ˆë‹¤</p>
                        <button class="btn btn-primary" @click="addSection">ì„¹ì…˜ ì¶”ê°€í•˜ê¸°</button>
                    </div>
                </div>
                <div class="card-footer bg-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <span class="text-muted small">ì´ {{ getTotalLessons() }}ê°œ ì°¨ì‹œ Â· {{ getTotalDuration() }}</span>
                        <button class="btn btn-primary" @click="saveCurriculum">ğŸ’¾ ì €ì¥</button>
                    </div>
                </div>
            </div>

            <!-- ê°•ì¢Œ ë¯¸ì„ íƒ ìƒíƒœ -->
            <div class="card border-0 shadow-sm" v-else>
                <div class="card-body text-center py-5 text-muted">
                    <span class="fs-1">ğŸ‘ˆ</span>
                    <p class="mt-2">ì™¼ìª½ì—ì„œ ê°•ì¢Œë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.cursor-grab { cursor: grab; }
.cursor-grab:active { cursor: grabbing; }
</style>

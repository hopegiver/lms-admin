<div class="settlements-page">
    <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">Ï†ïÏÇ∞</h4>
            <p class="text-muted mb-0">Í∞ïÏÇ¨ Ï†ïÏÇ∞ÏùÑ Í¥ÄÎ¶¨Ìï©ÎãàÎã§</p>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-outline-secondary" @click="exportSettlements">
                <span class="me-1">üì•</span> ÎÇ¥Ïó≠ Îã§Ïö¥Î°úÎìú
            </button>
            <button class="btn btn-primary" @click="processSettlement">
                <span class="me-1">üí∞</span> ÏùºÍ¥Ñ Ï†ïÏÇ∞
            </button>
        </div>
    </div>

    <!-- Ï†ïÏÇ∞ ÏöîÏïΩ Ïπ¥Îìú -->
    <div class="row g-3 mb-4">
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ïù¥Î≤àÎã¨ Îß§Ï∂ú</div>
                            <div class="fs-4 fw-bold">{{ stats.monthlyRevenue }}</div>
                        </div>
                        <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                            <span class="fs-4">üíµ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ï†ïÏÇ∞ ÏòàÏ†ï</div>
                            <div class="fs-4 fw-bold text-warning">{{ stats.pendingSettlement }}</div>
                        </div>
                        <div class="rounded-circle bg-warning bg-opacity-10 p-3">
                            <span class="fs-4">‚è≥</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ï†ïÏÇ∞ ÏôÑÎ£å</div>
                            <div class="fs-4 fw-bold text-success">{{ stats.completedSettlement }}</div>
                        </div>
                        <div class="rounded-circle bg-success bg-opacity-10 p-3">
                            <span class="fs-4">‚úÖ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ÌîåÎû´Ìèº ÏàòÏàòÎ£å</div>
                            <div class="fs-4 fw-bold">{{ stats.platformFee }}</div>
                        </div>
                        <div class="rounded-circle bg-info bg-opacity-10 p-3">
                            <span class="fs-4">üìä</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
    <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'pending' }" href="#" @click.prevent="activeTab = 'pending'">
                Ï†ïÏÇ∞ ÎåÄÍ∏∞ <span class="badge bg-warning ms-1">{{ pendingList.length }}</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'completed' }" href="#" @click.prevent="activeTab = 'completed'">
                Ï†ïÏÇ∞ ÏôÑÎ£å
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'instructors' }" href="#" @click.prevent="activeTab = 'instructors'">
                Í∞ïÏÇ¨Î≥Ñ ÌòÑÌô©
            </a>
        </li>
    </ul>

    <!-- Ï†ïÏÇ∞ ÎåÄÍ∏∞ ÌÉ≠ -->
    <div v-if="activeTab === 'pending'">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th><input type="checkbox" class="form-check-input"></th>
                                <th>Í∞ïÏÇ¨</th>
                                <th>Ï†ïÏÇ∞Í∏∞Í∞Ñ</th>
                                <th class="text-end">Îß§Ï∂úÏï°</th>
                                <th class="text-end">ÏàòÏàòÎ£å(20%)</th>
                                <th class="text-end">Ï†ïÏÇ∞Í∏àÏï°</th>
                                <th class="text-center">ÏÉÅÌÉú</th>
                                <th style="width: 100px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="item in pendingList" :key="item.id">
                                <td><input type="checkbox" class="form-check-input"></td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="rounded-circle bg-primary bg-opacity-10 text-primary d-flex align-items-center justify-content-center me-2"
                                             style="width: 36px; height: 36px;">
                                            {{ item.instructor.charAt(0) }}
                                        </div>
                                        <div>
                                            <div class="fw-medium">{{ item.instructor }}</div>
                                            <div class="text-muted small">{{ item.email }}</div>
                                        </div>
                                    </div>
                                </td>
                                <td>{{ item.period }}</td>
                                <td class="text-end">{{ item.revenue }}</td>
                                <td class="text-end text-muted">{{ item.fee }}</td>
                                <td class="text-end fw-bold text-primary">{{ item.settlement }}</td>
                                <td class="text-center">
                                    <span class="badge bg-warning">ÎåÄÍ∏∞</span>
                                </td>
                                <td>
                                    <button class="btn btn-sm btn-primary" @click="processOne(item)">Ï†ïÏÇ∞</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Ï†ïÏÇ∞ ÏôÑÎ£å ÌÉ≠ -->
    <div v-if="activeTab === 'completed'">
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-body">
                <div class="row g-3 align-items-center">
                    <div class="col-md-3">
                        <select class="form-select" v-model="completedFilter.instructor">
                            <option value="">Ï†ÑÏ≤¥ Í∞ïÏÇ¨</option>
                            <option v-for="ins in instructorList" :key="ins">{{ ins }}</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text bg-white">üìÖ</span>
                            <input type="month" class="form-control" v-model="completedFilter.month">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Ï†ïÏÇ∞Î≤àÌò∏</th>
                                <th>Í∞ïÏÇ¨</th>
                                <th>Ï†ïÏÇ∞Í∏∞Í∞Ñ</th>
                                <th class="text-end">Ï†ïÏÇ∞Í∏àÏï°</th>
                                <th>Í≥ÑÏ¢åÏ†ïÎ≥¥</th>
                                <th>Ï†ïÏÇ∞Ïùº</th>
                                <th style="width: 80px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="item in completedList" :key="item.id">
                                <td><span class="fw-medium">{{ item.settlementNo }}</span></td>
                                <td>{{ item.instructor }}</td>
                                <td>{{ item.period }}</td>
                                <td class="text-end fw-bold">{{ item.amount }}</td>
                                <td>
                                    <div class="small">{{ item.bank }}</div>
                                    <div class="text-muted small">{{ item.account }}</div>
                                </td>
                                <td>{{ item.settledDate }}</td>
                                <td>
                                    <button class="btn btn-sm btn-link text-muted" @click="viewDetail(item)">ÏÉÅÏÑ∏</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Í∞ïÏÇ¨Î≥Ñ ÌòÑÌô© ÌÉ≠ -->
    <div v-if="activeTab === 'instructors'">
        <div class="row g-4">
            <div class="col-md-6 col-lg-4" v-for="instructor in instructorStats" :key="instructor.id">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="rounded-circle bg-primary bg-opacity-10 text-primary d-flex align-items-center justify-content-center me-3"
                                 style="width: 48px; height: 48px; font-size: 1.2rem;">
                                {{ instructor.name.charAt(0) }}
                            </div>
                            <div>
                                <div class="fw-bold">{{ instructor.name }}</div>
                                <div class="text-muted small">{{ instructor.courses }}Í∞ú Í∞ïÏ¢å</div>
                            </div>
                        </div>
                        <div class="row g-2 text-center">
                            <div class="col-4">
                                <div class="bg-light rounded p-2">
                                    <div class="text-muted small">Ï¥ù Îß§Ï∂ú</div>
                                    <div class="fw-bold small">{{ instructor.totalRevenue }}</div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="bg-light rounded p-2">
                                    <div class="text-muted small">Ï†ïÏÇ∞ÏôÑÎ£å</div>
                                    <div class="fw-bold small text-success">{{ instructor.settled }}</div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="bg-light rounded p-2">
                                    <div class="text-muted small">ÎØ∏Ï†ïÏÇ∞</div>
                                    <div class="fw-bold small text-warning">{{ instructor.pending }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="d-flex justify-content-between">
                            <button class="btn btn-sm btn-outline-secondary" @click="viewInstructorDetail(instructor)">ÏÉÅÏÑ∏Î≥¥Í∏∞</button>
                            <button class="btn btn-sm btn-outline-primary" @click="editCommission(instructor)">ÏàòÏàòÎ£å ÏÑ§Ï†ï</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
    <div class="d-flex justify-content-center mt-4" v-if="activeTab !== 'instructors'">
        <nav>
            <ul class="pagination">
                <li class="page-item disabled"><a class="page-link" href="#">Ïù¥Ï†Ñ</a></li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">Îã§Ïùå</a></li>
            </ul>
        </nav>
    </div>
</div>

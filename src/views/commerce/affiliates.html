<div class="affiliates-page">
    <!-- í˜ì´ì§€ í—¤ë” -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">ì œíœ´</h4>
            <p class="text-muted mb-0">ì œíœ´ íŒŒíŠ¸ë„ˆì™€ ì¶”ì²œì¸ í”„ë¡œê·¸ë¨ì„ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
        </div>
        <button class="btn btn-primary" @click="openPartnerModal">
            <span class="me-1">ğŸ¤</span> íŒŒíŠ¸ë„ˆ ë“±ë¡
        </button>
    </div>

    <!-- í†µê³„ ì¹´ë“œ -->
    <div class="row g-3 mb-4">
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">í™œì„± íŒŒíŠ¸ë„ˆ</div>
                            <div class="fs-4 fw-bold">{{ stats.activePartners }}</div>
                        </div>
                        <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                            <span class="fs-4">ğŸ¤</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ì œíœ´ ë§¤ì¶œ</div>
                            <div class="fs-4 fw-bold text-success">{{ stats.affiliateRevenue }}</div>
                        </div>
                        <div class="rounded-circle bg-success bg-opacity-10 p-3">
                            <span class="fs-4">ğŸ’°</span>
                        </div>
                    </div>
                    <div class="mt-2 small">
                        <span class="text-success">â–² 15%</span>
                        <span class="text-muted ms-1">ì „ì›” ëŒ€ë¹„</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ì¶”ì²œ ê°€ì…</div>
                            <div class="fs-4 fw-bold">{{ stats.referralSignups }}</div>
                        </div>
                        <div class="rounded-circle bg-info bg-opacity-10 p-3">
                            <span class="fs-4">ğŸ‘¥</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ì§€ê¸‰ ì»¤ë¯¸ì…˜</div>
                            <div class="fs-4 fw-bold text-warning">{{ stats.paidCommission }}</div>
                        </div>
                        <div class="rounded-circle bg-warning bg-opacity-10 p-3">
                            <span class="fs-4">ğŸ’¸</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
    <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'partners' }" href="#" @click.prevent="activeTab = 'partners'">
                ì œíœ´ íŒŒíŠ¸ë„ˆ
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'referrals' }" href="#" @click.prevent="activeTab = 'referrals'">
                ì¶”ì²œì¸ í”„ë¡œê·¸ë¨
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'commissions' }" href="#" @click.prevent="activeTab = 'commissions'">
                ì»¤ë¯¸ì…˜ ë‚´ì—­
            </a>
        </li>
    </ul>

    <!-- ì œíœ´ íŒŒíŠ¸ë„ˆ íƒ­ -->
    <div v-if="activeTab === 'partners'">
        <div class="row g-4">
            <div class="col-md-6 col-lg-4" v-for="partner in partners" :key="partner.id">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center">
                        <span class="badge" :class="partner.status === 'active' ? 'bg-success' : 'bg-secondary'">
                            {{ partner.status === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±' }}
                        </span>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-link text-muted p-0" data-bs-toggle="dropdown">â‹®</button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#" @click="editPartner(partner)">ìˆ˜ì •</a></li>
                                <li><a class="dropdown-item" href="#" @click="viewPartnerStats(partner)">í†µê³„ë³´ê¸°</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" href="#" @click="deactivatePartner(partner)">ë¹„í™œì„±í™”</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="d-flex align-items-center mb-3">
                            <div class="rounded bg-light d-flex align-items-center justify-content-center me-3"
                                 style="width: 48px; height: 48px;">
                                <span class="fs-4">ğŸ¢</span>
                            </div>
                            <div>
                                <div class="fw-bold">{{ partner.name }}</div>
                                <div class="text-muted small">{{ partner.type }}</div>
                            </div>
                        </div>
                        <div class="row g-2 mb-3">
                            <div class="col-6">
                                <div class="text-muted small">ì»¤ë¯¸ì…˜ìœ¨</div>
                                <div class="fw-medium">{{ partner.commission }}</div>
                            </div>
                            <div class="col-6">
                                <div class="text-muted small">ê³„ì•½ê¸°ê°„</div>
                                <div class="fw-medium">{{ partner.contractPeriod }}</div>
                            </div>
                        </div>
                        <div class="bg-light rounded p-2">
                            <div class="d-flex justify-content-between small">
                                <span class="text-muted">ì´ë²ˆë‹¬ ë§¤ì¶œ</span>
                                <span class="fw-bold">{{ partner.monthlyRevenue }}</span>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="d-flex justify-content-between align-items-center small text-muted">
                            <span>ì½”ë“œ: <code>{{ partner.code }}</code></span>
                            <span>{{ partner.referrals }}ëª… ìœ ì…</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì¶”ì²œì¸ í”„ë¡œê·¸ë¨ íƒ­ -->
    <div v-if="activeTab === 'referrals'">
        <div class="row g-4 mb-4">
            <div class="col-lg-8">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">ì¶”ì²œì¸ í˜„í™©</h6>
                        <button class="btn btn-sm btn-outline-primary" @click="editReferralProgram">ì„¤ì •</button>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>ì¶”ì²œì¸</th>
                                        <th class="text-center">ì¶”ì²œìˆ˜</th>
                                        <th class="text-end">ì´ ì ë¦½ê¸ˆ</th>
                                        <th class="text-center">ë“±ê¸‰</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-for="referrer in topReferrers" :key="referrer.id">
                                        <td>
                                            <div class="d-flex align-items-center">
                                                <div class="rounded-circle bg-primary bg-opacity-10 text-primary d-flex align-items-center justify-content-center me-2"
                                                     style="width: 32px; height: 32px;">
                                                    {{ referrer.name.charAt(0) }}
                                                </div>
                                                <div>
                                                    <div class="fw-medium">{{ referrer.name }}</div>
                                                    <div class="text-muted small">{{ referrer.email }}</div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="text-center">{{ referrer.referrals }}ëª…</td>
                                        <td class="text-end fw-bold">{{ referrer.earnings }}</td>
                                        <td class="text-center">
                                            <span class="badge" :class="getRankBadgeClass(referrer.rank)">{{ referrer.rank }}</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white">
                        <h6 class="mb-0">í”„ë¡œê·¸ë¨ ì„¤ì •</h6>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label class="form-label text-muted small">ì¶”ì²œì¸ í˜œíƒ</label>
                            <div class="fw-medium">{{ referralProgram.referrerReward }}</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label text-muted small">í”¼ì¶”ì²œì¸ í˜œíƒ</label>
                            <div class="fw-medium">{{ referralProgram.refereeReward }}</div>
                        </div>
                        <div class="mb-3">
                            <label class="form-label text-muted small">ìµœì†Œ êµ¬ë§¤ì¡°ê±´</label>
                            <div class="fw-medium">{{ referralProgram.minPurchase }}</div>
                        </div>
                        <div>
                            <label class="form-label text-muted small">ìœ íš¨ê¸°ê°„</label>
                            <div class="fw-medium">{{ referralProgram.validPeriod }}</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ì»¤ë¯¸ì…˜ ë‚´ì—­ íƒ­ -->
    <div v-if="activeTab === 'commissions'">
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-body">
                <div class="row g-3 align-items-center">
                    <div class="col-md-2">
                        <select class="form-select" v-model="commissionFilter.type">
                            <option value="">ì „ì²´ ìœ í˜•</option>
                            <option value="partner">ì œíœ´ íŒŒíŠ¸ë„ˆ</option>
                            <option value="referral">ì¶”ì²œì¸</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <select class="form-select" v-model="commissionFilter.status">
                            <option value="">ì „ì²´ ìƒíƒœ</option>
                            <option value="pending">ì§€ê¸‰ëŒ€ê¸°</option>
                            <option value="paid">ì§€ê¸‰ì™„ë£Œ</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text bg-white">ğŸ“…</span>
                            <input type="date" class="form-control" v-model="commissionFilter.startDate">
                            <input type="date" class="form-control" v-model="commissionFilter.endDate">
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="input-group">
                            <span class="input-group-text bg-white">ğŸ”</span>
                            <input type="text" class="form-control" placeholder="ê²€ìƒ‰..." v-model="commissionFilter.query">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>ìœ í˜•</th>
                                <th>íŒŒíŠ¸ë„ˆ/ì¶”ì²œì¸</th>
                                <th>ì£¼ë¬¸ë²ˆí˜¸</th>
                                <th class="text-end">ì£¼ë¬¸ê¸ˆì•¡</th>
                                <th class="text-end">ì»¤ë¯¸ì…˜</th>
                                <th class="text-center">ìƒíƒœ</th>
                                <th>ë°œìƒì¼</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="commission in commissions" :key="commission.id">
                                <td>
                                    <span class="badge" :class="commission.type === 'partner' ? 'bg-primary' : 'bg-info'">
                                        {{ commission.type === 'partner' ? 'ì œíœ´' : 'ì¶”ì²œ' }}
                                    </span>
                                </td>
                                <td>{{ commission.source }}</td>
                                <td><a href="#" class="text-primary">{{ commission.orderNo }}</a></td>
                                <td class="text-end">{{ commission.orderAmount }}</td>
                                <td class="text-end fw-bold text-success">{{ commission.commission }}</td>
                                <td class="text-center">
                                    <span class="badge" :class="commission.status === 'paid' ? 'bg-success' : 'bg-warning'">
                                        {{ commission.status === 'paid' ? 'ì§€ê¸‰ì™„ë£Œ' : 'ì§€ê¸‰ëŒ€ê¸°' }}
                                    </span>
                                </td>
                                <td>{{ commission.createdAt }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <div class="d-flex justify-content-center mt-4" v-if="activeTab === 'commissions'">
        <nav>
            <ul class="pagination">
                <li class="page-item disabled"><a class="page-link" href="#">ì´ì „</a></li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">ë‹¤ìŒ</a></li>
            </ul>
        </nav>
    </div>
</div>

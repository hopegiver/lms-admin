<div class="promotions-page">
    <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">ÌîÑÎ°úÎ™®ÏÖò</h4>
            <p class="text-muted mb-0">Ïø†Ìè∞Í≥º Ìï†Ïù∏ Ïù¥Î≤§Ìä∏Î•º Í¥ÄÎ¶¨Ìï©ÎãàÎã§</p>
        </div>
        <div class="d-flex gap-2">
            <button class="btn btn-outline-primary" @click="openCouponModal">
                <span class="me-1">üéüÔ∏è</span> Ïø†Ìè∞ ÏÉùÏÑ±
            </button>
            <button class="btn btn-primary" @click="openEventModal">
                <span class="me-1">üéâ</span> Ïù¥Î≤§Ìä∏ ÏÉùÏÑ±
            </button>
        </div>
    </div>

    <!-- ÌÜµÍ≥Ñ Ïπ¥Îìú -->
    <div class="row g-3 mb-4">
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ÏßÑÌñâÏ§ë Ïù¥Î≤§Ìä∏</div>
                            <div class="fs-4 fw-bold text-success">{{ stats.activeEvents }}</div>
                        </div>
                        <div class="rounded-circle bg-success bg-opacity-10 p-3">
                            <span class="fs-4">üéâ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Î∞úÍ∏â Ïø†Ìè∞</div>
                            <div class="fs-4 fw-bold">{{ stats.issuedCoupons }}</div>
                        </div>
                        <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                            <span class="fs-4">üéüÔ∏è</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ïø†Ìè∞ ÏÇ¨Ïö©Î•†</div>
                            <div class="fs-4 fw-bold">{{ stats.usageRate }}</div>
                        </div>
                        <div class="rounded-circle bg-warning bg-opacity-10 p-3">
                            <span class="fs-4">üìä</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ï¥ù Ìï†Ïù∏Í∏àÏï°</div>
                            <div class="fs-4 fw-bold text-danger">{{ stats.totalDiscount }}</div>
                        </div>
                        <div class="rounded-circle bg-danger bg-opacity-10 p-3">
                            <span class="fs-4">üí∏</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌÉ≠ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
    <ul class="nav nav-tabs mb-4">
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'events' }" href="#" @click.prevent="activeTab = 'events'">
                Ìï†Ïù∏ Ïù¥Î≤§Ìä∏ <span class="badge bg-success ms-1">{{ events.length }}</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'coupons' }" href="#" @click.prevent="activeTab = 'coupons'">
                Ïø†Ìè∞ Í¥ÄÎ¶¨ <span class="badge bg-secondary ms-1">{{ coupons.length }}</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" :class="{ active: activeTab === 'usage' }" href="#" @click.prevent="activeTab = 'usage'">
                ÏÇ¨Ïö© ÎÇ¥Ïó≠
            </a>
        </li>
    </ul>

    <!-- Ìï†Ïù∏ Ïù¥Î≤§Ìä∏ ÌÉ≠ -->
    <div v-if="activeTab === 'events'">
        <div class="row g-4">
            <div class="col-md-6 col-lg-4" v-for="event in events" :key="event.id">
                <div class="card border-0 shadow-sm h-100">
                    <div class="card-header bg-white d-flex justify-content-between align-items-center">
                        <span class="badge" :class="event.status === 'active' ? 'bg-success' : 'bg-secondary'">
                            {{ event.status === 'active' ? 'ÏßÑÌñâÏ§ë' : 'Ï¢ÖÎ£å' }}
                        </span>
                        <div class="dropdown">
                            <button class="btn btn-sm btn-link text-muted p-0" data-bs-toggle="dropdown">‚ãÆ</button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="#" @click="editEvent(event)">ÏàòÏ†ï</a></li>
                                <li><a class="dropdown-item" href="#" @click="duplicateEvent(event)">Î≥µÏ†ú</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" href="#" @click="deleteEvent(event)">ÏÇ≠Ï†ú</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card-body">
                        <h6 class="fw-bold mb-2" @click="viewDetail(event)" style="cursor: pointer;">{{ event.name }}</h6>
                        <p class="text-muted small mb-3">{{ event.description }}</p>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="text-muted small">Ìï†Ïù∏Ïú®</span>
                            <span class="fw-bold text-danger">{{ event.discount }}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="text-muted small">ÎåÄÏÉÅ</span>
                            <span class="badge bg-light text-dark">{{ event.target }}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted small">Í∏∞Í∞Ñ</span>
                            <span class="small">{{ event.period }}</span>
                        </div>
                    </div>
                    <div class="card-footer bg-transparent">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="small text-muted">{{ event.usedCount }}Ìöå Ï†ÅÏö©</span>
                            <button class="btn btn-sm" :class="event.status === 'active' ? 'btn-outline-danger' : 'btn-outline-success'"
                                    @click="toggleEventStatus(event)">
                                {{ event.status === 'active' ? 'Ï¢ÖÎ£å' : 'ÌôúÏÑ±Ìôî' }}
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ïø†Ìè∞ Í¥ÄÎ¶¨ ÌÉ≠ -->
    <div v-if="activeTab === 'coupons'">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Ïø†Ìè∞ÏΩîÎìú</th>
                                <th>Ïø†Ìè∞Î™Ö</th>
                                <th>Ìï†Ïù∏</th>
                                <th class="text-center">Î∞úÍ∏â/ÏÇ¨Ïö©</th>
                                <th>Ïú†Ìö®Í∏∞Í∞Ñ</th>
                                <th class="text-center">ÏÉÅÌÉú</th>
                                <th style="width: 120px;"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="coupon in coupons" :key="coupon.id">
                                <td>
                                    <code class="bg-light px-2 py-1 rounded">{{ coupon.code }}</code>
                                </td>
                                <td>
                                    <div class="fw-medium" @click="viewDetail(coupon)" style="cursor: pointer;">{{ coupon.name }}</div>
                                    <div class="text-muted small">{{ coupon.target }}</div>
                                </td>
                                <td>
                                    <span class="text-danger fw-bold">{{ coupon.discount }}</span>
                                </td>
                                <td class="text-center">
                                    <span class="fw-medium">{{ coupon.used }}</span>
                                    <span class="text-muted"> / {{ coupon.issued }}</span>
                                </td>
                                <td>{{ coupon.validPeriod }}</td>
                                <td class="text-center">
                                    <span class="badge" :class="getCouponStatusClass(coupon.status)">
                                        {{ getCouponStatusText(coupon.status) }}
                                    </span>
                                </td>
                                <td>
                                    <div class="d-flex gap-1">
                                        <button class="btn btn-sm btn-outline-primary" @click="editCoupon(coupon)">ÏàòÏ†ï</button>
                                        <button class="btn btn-sm btn-outline-secondary" @click="issueCoupon(coupon)">Î∞úÍ∏â</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏÇ¨Ïö© ÎÇ¥Ïó≠ ÌÉ≠ -->
    <div v-if="activeTab === 'usage'">
        <div class="card border-0 shadow-sm mb-4">
            <div class="card-body">
                <div class="row g-3 align-items-center">
                    <div class="col-md-3">
                        <select class="form-select" v-model="usageFilter.type">
                            <option value="">Ï†ÑÏ≤¥ Ïú†Ìòï</option>
                            <option value="coupon">Ïø†Ìè∞</option>
                            <option value="event">Ïù¥Î≤§Ìä∏</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text bg-white">üìÖ</span>
                            <input type="date" class="form-control" v-model="usageFilter.startDate">
                            <input type="date" class="form-control" v-model="usageFilter.endDate">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text bg-white">üîç</span>
                            <input type="text" class="form-control" placeholder="Ïø†Ìè∞ÏΩîÎìú, ÏÇ¨Ïö©Ïûê..." v-model="usageFilter.query">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card border-0 shadow-sm">
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Ïú†Ìòï</th>
                                <th>ÌîÑÎ°úÎ™®ÏÖòÎ™Ö</th>
                                <th>ÏÇ¨Ïö©Ïûê</th>
                                <th>Ï£ºÎ¨∏Î≤àÌò∏</th>
                                <th class="text-end">Ìï†Ïù∏Í∏àÏï°</th>
                                <th>ÏÇ¨Ïö©ÏùºÏãú</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr v-for="usage in usageHistory" :key="usage.id">
                                <td>
                                    <span class="badge" :class="usage.type === 'coupon' ? 'bg-primary' : 'bg-success'">
                                        {{ usage.type === 'coupon' ? 'Ïø†Ìè∞' : 'Ïù¥Î≤§Ìä∏' }}
                                    </span>
                                </td>
                                <td>{{ usage.promotionName }}</td>
                                <td>{{ usage.user }}</td>
                                <td><a href="#" class="text-primary">{{ usage.orderNo }}</a></td>
                                <td class="text-end fw-bold text-danger">-{{ usage.discountAmount }}</td>
                                <td>{{ usage.usedAt }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
    <div class="d-flex justify-content-center mt-4" v-if="activeTab === 'usage'">
        <nav>
            <ul class="pagination">
                <li class="page-item disabled"><a class="page-link" href="#">Ïù¥Ï†Ñ</a></li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">Îã§Ïùå</a></li>
            </ul>
        </nav>
    </div>
</div>

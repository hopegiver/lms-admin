<div class="sms-sending-page">
    <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">SMS Î∞úÏÜ°</h4>
            <p class="text-muted mb-0">Í∞úÎ≥Ñ SMS/LMSÎ•º Îπ†Î•¥Í≤å Î∞úÏÜ°Ìï©ÎãàÎã§</p>
        </div>
        <button class="btn btn-outline-secondary" @click="navigateTo('/marketing/campaigns')">
            Îí§Î°ú Í∞ÄÍ∏∞
        </button>
    </div>

    <div class="row">
        <!-- ÏôºÏ™Ω: ÏûëÏÑ± ÏòÅÏó≠ -->
        <div class="col-lg-7">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <!-- Î∞úÏã† Ï†ïÎ≥¥ -->
                    <div class="mb-4">
                        <h6 class="mb-3">Î∞úÏã† Ï†ïÎ≥¥</h6>
                        <div class="row g-3">
                            <div class="col-12">
                                <label class="form-label">Î∞úÏã†Î≤àÌò∏</label>
                                <select class="form-select" v-model="smsForm.senderNumber">
                                    <option value="1588-0000">1588-0000</option>
                                    <option value="1588-0001">1588-0001</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <!-- Î©îÏãúÏßÄ ÏûëÏÑ± -->
                    <div class="mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6 class="mb-0">Î©îÏãúÏßÄ ÏûëÏÑ±</h6>
                            <span class="badge" :class="messageType === 'SMS' ? 'bg-success' : 'bg-primary'">
                                {{ messageType }}
                            </span>
                        </div>
                        <div class="mb-2">
                            <div class="btn-group btn-group-sm mb-2">
                                <button type="button" class="btn btn-outline-secondary" @click="insertVariable('Ïù¥Î¶Ñ')">
                                    {{Ïù¥Î¶Ñ}}
                                </button>
                                <button type="button" class="btn btn-outline-secondary" @click="insertVariable('Í∞ïÏ¢åÎ™Ö')">
                                    {{Í∞ïÏ¢åÎ™Ö}}
                                </button>
                                <button type="button" class="btn btn-outline-secondary" @click="insertVariable('ÏßÑÎèÑÏú®')">
                                    {{ÏßÑÎèÑÏú®}}
                                </button>
                                <button type="button" class="btn btn-outline-secondary" @click="insertVariable('ÎÇ®ÏùÄÏùºÏàò')">
                                    {{ÎÇ®ÏùÄÏùºÏàò}}
                                </button>
                            </div>
                        </div>
                        <div class="mb-2">
                            <textarea class="form-control" rows="8" v-model="smsForm.message"
                                      :placeholder="'Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî. ' + (messageType === 'SMS' ? '90 byte Ï¥àÍ≥º Ïãú LMSÎ°ú Î∞úÏÜ°Îê©ÎãàÎã§.' : 'LMSÎäî ÏµúÎåÄ 2000byteÍπåÏßÄ ÏûÖÎ†• Í∞ÄÎä•Ìï©ÎãàÎã§.')"></textarea>
                        </div>
                        <div class="d-flex justify-content-between align-items-center small text-muted">
                            <span>{{ messageLength }}Ïûê / {{ messageByte }} byte</span>
                            <span>ÏµúÎåÄ: {{ maxLength }} byte</span>
                        </div>
                        <div v-if="messageByte > maxLength" class="alert alert-warning small mt-2 mb-0">
                            Î©îÏãúÏßÄ Í∏∏Ïù¥Í∞Ä {{ messageType }} ÏµúÎåÄ byteÎ•º Ï¥àÍ≥ºÌñàÏäµÎãàÎã§.
                        </div>
                    </div>

                    <hr>

                    <!-- ÏàòÏã† ÎåÄÏÉÅ -->
                    <div class="mb-4">
                        <h6 class="mb-3">ÏàòÏã† ÎåÄÏÉÅ <span class="text-danger">*</span></h6>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" v-model="smsForm.targetType"
                                   value="all" id="targetAll">
                            <label class="form-check-label" for="targetAll">
                                Ï†ÑÏ≤¥ Î∞úÏÜ° (5,230Î™Ö)
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" v-model="smsForm.targetType"
                                   value="groups" id="targetGroups">
                            <label class="form-check-label" for="targetGroups">
                                Í∑∏Î£π ÏÑ†ÌÉù
                            </label>
                        </div>

                        <div v-if="smsForm.targetType === 'groups'" class="ms-4">
                            <div v-for="group in availableGroups" :key="group.id" class="form-check mb-2">
                                <input class="form-check-input" type="checkbox"
                                       :value="group.id" v-model="smsForm.targetGroups"
                                       :id="'group-' + group.id">
                                <label class="form-check-label" :for="'group-' + group.id">
                                    {{ group.name }} <span class="text-muted">({{ group.count.toLocaleString() }}Î™Ö)</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <!-- Î∞úÏÜ° ÏãúÍ∞Ñ -->
                    <div class="mb-0">
                        <h6 class="mb-3">Î∞úÏÜ° ÏãúÍ∞Ñ</h6>
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="radio" v-model="smsForm.scheduleType"
                                   value="now" id="scheduleNow">
                            <label class="form-check-label" for="scheduleNow">
                                Ï¶âÏãú Î∞úÏÜ°
                            </label>
                        </div>
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="radio" v-model="smsForm.scheduleType"
                                   value="schedule" id="scheduleTime">
                            <label class="form-check-label" for="scheduleTime">
                                ÏòàÏïΩ Î∞úÏÜ°
                            </label>
                        </div>
                        <div v-if="smsForm.scheduleType === 'schedule'" class="row g-2 ms-4">
                            <div class="col-md-6">
                                <input type="date" class="form-control" v-model="smsForm.scheduleDate">
                            </div>
                            <div class="col-md-6">
                                <input type="time" class="form-control" v-model="smsForm.scheduleTime">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ïò§Î•∏Ï™Ω: ÎØ∏Î¶¨Î≥¥Í∏∞ ÏòÅÏó≠ -->
        <div class="col-lg-5">
            <div class="card border-0 shadow-sm sticky-top" style="top: 80px;">
                <div class="card-header bg-white py-3">
                    <h6 class="mb-0">ÎØ∏Î¶¨Î≥¥Í∏∞</h6>
                </div>
                <div class="card-body">
                    <!-- SMS ÎØ∏Î¶¨Î≥¥Í∏∞ -->
                    <div class="border rounded p-3 mb-4 bg-light" style="min-height: 300px;">
                        <div class="mb-3 pb-3 border-bottom">
                            <div class="small text-muted mb-1">Î∞úÏã†Î≤àÌò∏</div>
                            <div class="fw-medium">{{ smsForm.senderNumber }}</div>
                        </div>
                        <div class="mb-3 pb-3 border-bottom">
                            <div class="small text-muted mb-1">Î©îÏãúÏßÄ Ïú†Ìòï</div>
                            <span class="badge" :class="messageType === 'SMS' ? 'bg-success' : 'bg-primary'">
                                {{ messageType }}
                            </span>
                        </div>
                        <div style="white-space: pre-wrap; line-height: 1.6; font-family: monospace;">
                            {{ previewMessage || '(Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî)' }}
                        </div>
                    </div>

                    <hr>

                    <!-- Î∞úÏÜ° Ï†ïÎ≥¥ -->
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="text-muted small">Î∞úÏÜ° ÎåÄÏÉÅ</span>
                            <span class="fw-bold text-primary fs-5">{{ targetCount.toLocaleString() }}Î™Ö</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="text-muted small">Îã®Í∞Ä</span>
                            <span class="fw-medium">‚Ç©{{ (messageType === 'LMS' ? 30 : 20).toLocaleString() }}/Í±¥</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="text-muted small">ÏòàÏÉÅ ÎπÑÏö©</span>
                            <span class="fw-medium">‚Ç©{{ estimatedCost.toLocaleString() }}</span>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted small">Î∞úÏÜ° Î∞©Ïãù</span>
                            <span class="fw-medium">
                                <span v-if="smsForm.scheduleType === 'now'">Ï¶âÏãú Î∞úÏÜ°</span>
                                <span v-else-if="smsForm.scheduleDate && smsForm.scheduleTime">
                                    {{ smsForm.scheduleDate }} {{ smsForm.scheduleTime }}
                                </span>
                                <span v-else class="text-muted">(ÎØ∏ÏÑ§Ï†ï)</span>
                            </span>
                        </div>
                    </div>

                    <div class="alert alert-info small mb-3">
                        Î∞úÏÜ° ÌõÑ Î∞úÏÜ° ÎÇ¥Ïó≠ÏóêÏÑú Í≤∞Í≥ºÎ•º ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                    </div>

                    <button class="btn btn-primary w-100 btn-lg" @click="sendSms">
                        <span class="me-1">üí¨</span> SMS Î∞úÏÜ°
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

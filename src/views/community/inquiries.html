<div class="inquiries-page">
    <!-- ÌéòÏù¥ÏßÄ Ìó§Îçî -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h4 class="mb-1">Î¨∏Ïùò Í¥ÄÎ¶¨</h4>
            <p class="text-muted mb-0">Í≥†Í∞ù Î¨∏ÏùòÎ•º ÌôïÏù∏ÌïòÍ≥† ÎãµÎ≥ÄÌï©ÎãàÎã§</p>
        </div>
        <button class="btn btn-outline-secondary" @click="exportInquiries">
            <span class="me-1">üì•</span> ÎÇ¥Î≥¥ÎÇ¥Í∏∞
        </button>
    </div>

    <!-- ÌÜµÍ≥Ñ Ïπ¥Îìú -->
    <div class="row g-3 mb-4">
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ï†ÑÏ≤¥ Î¨∏Ïùò</div>
                            <div class="fs-4 fw-bold">{{ stats.total }}</div>
                        </div>
                        <div class="rounded-circle bg-primary bg-opacity-10 p-3">
                            <span class="fs-4">üí¨</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ÎãµÎ≥Ä ÎåÄÍ∏∞</div>
                            <div class="fs-4 fw-bold text-warning">{{ stats.pending }}</div>
                        </div>
                        <div class="rounded-circle bg-warning bg-opacity-10 p-3">
                            <span class="fs-4">‚è≥</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">Ïò§Îäò Ï†ëÏàò</div>
                            <div class="fs-4 fw-bold text-info">{{ stats.today }}</div>
                        </div>
                        <div class="rounded-circle bg-info bg-opacity-10 p-3">
                            <span class="fs-4">üì©</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-sm-6 col-lg-3">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <div class="text-muted small">ÌèâÍ∑† ÏùëÎãµÏãúÍ∞Ñ</div>
                            <div class="fs-4 fw-bold text-success">{{ stats.avgResponseTime }}</div>
                        </div>
                        <div class="rounded-circle bg-success bg-opacity-10 p-3">
                            <span class="fs-4">‚ö°</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÌïÑÌÑ∞ -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-body">
            <div class="row g-3 align-items-center">
                <div class="col-md-2">
                    <select class="form-select" v-model="filters.status">
                        <option value="">Ï†ÑÏ≤¥ ÏÉÅÌÉú</option>
                        <option value="pending">ÎãµÎ≥ÄÎåÄÍ∏∞</option>
                        <option value="answered">ÎãµÎ≥ÄÏôÑÎ£å</option>
                        <option value="closed">Ï¢ÖÎ£å</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <select class="form-select" v-model="filters.category">
                        <option value="">Ï†ÑÏ≤¥ Ïú†Ìòï</option>
                        <option value="payment">Í≤∞Ï†ú/ÌôòÎ∂à</option>
                        <option value="course">Í∞ïÏ¢åÎ¨∏Ïùò</option>
                        <option value="tech">Í∏∞Ïà†ÏßÄÏõê</option>
                        <option value="account">Í≥ÑÏ†ïÎ¨∏Ïùò</option>
                        <option value="etc">Í∏∞ÌÉÄ</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <select class="form-select" v-model="filters.priority">
                        <option value="">Ï†ÑÏ≤¥ Ïö∞ÏÑ†ÏàúÏúÑ</option>
                        <option value="high">Í∏¥Í∏â</option>
                        <option value="normal">ÏùºÎ∞ò</option>
                        <option value="low">ÎÇÆÏùå</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <div class="input-group">
                        <span class="input-group-text bg-white">üîç</span>
                        <input type="text" class="form-control" placeholder="Ï†úÎ™©, ÏûëÏÑ±Ïûê Í≤ÄÏÉâ..." v-model="searchQuery">
                    </div>
                </div>
                <div class="col-md-2 text-end">
                    <button class="btn btn-outline-secondary" @click="resetFilters">Ï¥àÍ∏∞Ìôî</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Î¨∏Ïùò Î™©Î°ù -->
    <div class="card border-0 shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th style="width: 40px;"><input type="checkbox" class="form-check-input"></th>
                            <th style="width: 80px;">Ïö∞ÏÑ†ÏàúÏúÑ</th>
                            <th>Ï†úÎ™©</th>
                            <th>Ïú†Ìòï</th>
                            <th>ÏûëÏÑ±Ïûê</th>
                            <th class="text-center">ÏÉÅÌÉú</th>
                            <th>Ï†ëÏàòÏùº</th>
                            <th style="width: 100px;"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="inquiry in inquiries" :key="inquiry.id" @click="openInquiryDetail(inquiry)" style="cursor: pointer;">
                            <td @click.stop><input type="checkbox" class="form-check-input"></td>
                            <td>
                                <span class="badge" :class="getPriorityBadgeClass(inquiry.priority)">
                                    {{ getPriorityText(inquiry.priority) }}
                                </span>
                            </td>
                            <td>
                                <div class="fw-medium">{{ inquiry.title }}</div>
                                <div class="text-muted small text-truncate" style="max-width: 300px;">{{ inquiry.preview }}</div>
                            </td>
                            <td><span class="badge bg-light text-dark">{{ getCategoryText(inquiry.category) }}</span></td>
                            <td>
                                <div>{{ inquiry.author }}</div>
                                <div class="text-muted small">{{ inquiry.email }}</div>
                            </td>
                            <td class="text-center">
                                <span class="badge" :class="getStatusBadgeClass(inquiry.status)">
                                    {{ getStatusText(inquiry.status) }}
                                </span>
                            </td>
                            <td>{{ inquiry.createdAt }}</td>
                            <td @click.stop>
                                <div class="dropdown">
                                    <button class="btn btn-sm btn-link text-muted" data-bs-toggle="dropdown">‚ãÆ</button>
                                    <ul class="dropdown-menu dropdown-menu-end">
                                        <li><a class="dropdown-item" href="#" @click="openInquiryDetail(inquiry)">ÏÉÅÏÑ∏Î≥¥Í∏∞</a></li>
                                        <li><a class="dropdown-item" href="#" @click="replyInquiry(inquiry)">ÎãµÎ≥ÄÌïòÍ∏∞</a></li>
                                        <li><hr class="dropdown-divider"></li>
                                        <li><a class="dropdown-item" href="#" @click="closeInquiry(inquiry)">Î¨∏Ïùò Ï¢ÖÎ£å</a></li>
                                    </ul>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- ÌéòÏù¥ÏßÄÎÑ§Ïù¥ÏÖò -->
    <div class="d-flex justify-content-between align-items-center mt-4">
        <div class="text-muted small">Ï¥ù {{ inquiries.length }}Í±¥</div>
        <nav>
            <ul class="pagination mb-0">
                <li class="page-item disabled"><a class="page-link" href="#">Ïù¥Ï†Ñ</a></li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item"><a class="page-link" href="#">Îã§Ïùå</a></li>
            </ul>
        </nav>
    </div>
</div>

<!-- Î¨∏Ïùò ÏÉÅÏÑ∏ Ïä¨ÎùºÏù¥Îìú Ìå®ÎÑê -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="inquiryDetailPanel" style="width: 550px;">
    <div class="offcanvas-header border-bottom">
        <h5 class="offcanvas-title">Î¨∏Ïùò ÏÉÅÏÑ∏</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body" v-if="selectedInquiry">
        <!-- Î¨∏Ïùò Ï†ïÎ≥¥ -->
        <div class="mb-4">
            <div class="d-flex justify-content-between align-items-start mb-3">
                <span class="badge" :class="getPriorityBadgeClass(selectedInquiry.priority)">
                    {{ getPriorityText(selectedInquiry.priority) }}
                </span>
                <span class="badge" :class="getStatusBadgeClass(selectedInquiry.status)">
                    {{ getStatusText(selectedInquiry.status) }}
                </span>
            </div>
            <h5 class="mb-3">{{ selectedInquiry.title }}</h5>
            <div class="d-flex gap-3 text-muted small mb-3">
                <span>{{ selectedInquiry.author }}</span>
                <span>{{ selectedInquiry.email }}</span>
                <span>{{ selectedInquiry.createdAt }}</span>
            </div>
            <div class="bg-light rounded p-3">
                {{ selectedInquiry.content }}
            </div>
        </div>

        <!-- ÎãµÎ≥Ä ÏòÅÏó≠ -->
        <div class="mb-4">
            <h6 class="mb-3">ÎãµÎ≥Ä</h6>
            <div v-if="selectedInquiry.reply" class="bg-primary bg-opacity-10 rounded p-3">
                <div class="d-flex justify-content-between mb-2">
                    <span class="fw-medium">Í¥ÄÎ¶¨Ïûê</span>
                    <span class="text-muted small">{{ selectedInquiry.replyDate }}</span>
                </div>
                <div>{{ selectedInquiry.reply }}</div>
            </div>
            <div v-else>
                <textarea class="form-control mb-2" rows="5" placeholder="ÎãµÎ≥ÄÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." v-model="replyContent"></textarea>
                <button class="btn btn-primary" @click="submitReply">ÎãµÎ≥Ä Îì±Î°ù</button>
            </div>
        </div>
    </div>
</div>
